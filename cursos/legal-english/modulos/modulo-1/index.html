<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Module 1 GRATIS: US & UK Court Systems | Legal English</title>
    <meta name="description" content="¬°M√ìDULO GRATIS! Aprende sobre sistemas judiciales de Estados Unidos y Reino Unido sin costo. Legal English Module 1 FREE.">
    <meta name="keywords" content="legal english gratis, m√≥dulo gratis ingl√©s jur√≠dico, US courts free, UK courts espa√±ol, curso gratis common law, legal english free module">
    <link rel="stylesheet" href="../../../../css/styles.css">
    <style>
        /* ============================================
           ESTILOS DEL M√ìDULO INTERACTIVO
           ============================================ */

        .module-layout {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 0;
            min-height: calc(100vh - 80px);
            max-width: 1600px;
            margin: 0 auto;
        }

        /* Video Section */
        .video-section {
            background: #000;
            position: sticky;
            top: 80px;
            height: calc(100vh - 80px);
            display: flex;
            flex-direction: column;
        }

        .video-container {
            flex: 1;
            position: relative;
            background: #000;
        }

        .video-container iframe,
        .video-container video {
            width: 100%;
            height: 100%;
            border: none;
        }

        .video-placeholder {
            width: 100%;
            height: 100%;
            display: flex;
            align-items: center;
            justify-content: center;
            background: linear-gradient(135deg, var(--primary) 0%, #2d4942 100%);
            color: var(--white);
            flex-direction: column;
            gap: 20px;
            padding: 40px;
            text-align: center;
        }

        .video-placeholder .icon {
            font-size: 5rem;
            opacity: 0.5;
        }

        .video-controls {
            background: var(--primary);
            padding: 15px 20px;
            display: flex;
            align-items: center;
            gap: 15px;
            border-top: 2px solid var(--secondary);
        }

        .video-controls .btn-control {
            background: var(--secondary);
            color: var(--primary);
            border: none;
            padding: 8px 16px;
            border-radius: 5px;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s;
        }

        .video-controls .btn-control:hover {
            transform: scale(1.05);
        }

        .time-markers {
            display: flex;
            gap: 8px;
            flex-wrap: wrap;
            flex: 1;
        }

        .time-marker {
            background: rgba(255, 255, 255, 0.1);
            color: var(--white);
            padding: 5px 10px;
            border-radius: 15px;
            font-size: 0.8rem;
            cursor: pointer;
            transition: all 0.3s;
            border: 1px solid transparent;
        }

        .time-marker:hover {
            background: var(--secondary);
            color: var(--primary);
        }

        .time-marker.active {
            border-color: var(--secondary);
            background: rgba(207, 168, 146, 0.3);
        }

        /* Content Section */
        .content-section {
            background: var(--light-bg);
            overflow-y: auto;
            height: calc(100vh - 80px);
            padding: 30px;
        }

        .module-header {
            background: var(--white);
            padding: 25px;
            border-radius: 15px;
            margin-bottom: 25px;
            box-shadow: var(--shadow);
            border-left: 5px solid var(--secondary);
        }

        .module-header h1 {
            color: var(--primary);
            font-size: 1.8rem;
            margin-bottom: 10px;
        }

        .module-meta {
            display: flex;
            gap: 20px;
            color: var(--text-light);
            font-size: 0.9rem;
            flex-wrap: wrap;
        }

        .module-meta span {
            display: flex;
            align-items: center;
            gap: 5px;
        }

        /* Content Blocks */
        .content-block {
            background: var(--white);
            padding: 25px;
            border-radius: 15px;
            margin-bottom: 20px;
            box-shadow: var(--shadow);
            transition: all 0.3s;
        }

        .content-block.highlight {
            border-left: 5px solid var(--secondary);
        }

        .content-block h2 {
            color: var(--primary);
            font-size: 1.4rem;
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .content-block h3 {
            color: var(--primary);
            font-size: 1.2rem;
            margin: 20px 0 10px;
        }

        .content-block p {
            color: var(--text-dark);
            line-height: 1.8;
            margin-bottom: 15px;
        }

        .content-block ul {
            margin-left: 20px;
            margin-bottom: 15px;
        }

        .content-block li {
            margin-bottom: 8px;
            line-height: 1.6;
        }

        .content-block strong {
            color: var(--primary);
        }

        .pause-indicator {
            background: linear-gradient(135deg, #ff6b6b, #ee5a5a);
            color: white;
            padding: 15px 20px;
            border-radius: 10px;
            margin: 20px 0;
            display: flex;
            align-items: center;
            gap: 15px;
            cursor: pointer;
            transition: all 0.3s;
        }

        .pause-indicator:hover {
            transform: scale(1.02);
        }

        .pause-indicator .icon {
            font-size: 1.5rem;
        }

        .pause-indicator .text {
            flex: 1;
        }

        .pause-indicator .text strong {
            display: block;
            margin-bottom: 3px;
            color: white;
        }

        /* Exercise Blocks */
        .exercise-block {
            background: var(--white);
            border: 2px solid var(--secondary);
            border-radius: 15px;
            padding: 25px;
            margin-bottom: 20px;
        }

        .exercise-header {
            display: flex;
            align-items: center;
            gap: 15px;
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 2px solid var(--light-bg);
        }

        .exercise-number {
            background: var(--secondary);
            color: var(--primary);
            width: 50px;
            height: 50px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 700;
            font-size: 1.2rem;
            flex-shrink: 0;
        }

        .exercise-title {
            flex: 1;
        }

        .exercise-title h3 {
            color: var(--primary);
            margin: 0 0 5px;
        }

        .exercise-title span {
            color: var(--text-light);
            font-size: 0.85rem;
        }

        .exercise-content {
            margin-bottom: 20px;
        }

        /* Options List */
        .options-list {
            list-style: none;
            padding: 0;
            margin: 0;
        }

        .option-item {
            background: var(--light-bg);
            border: 2px solid transparent;
            border-radius: 10px;
            padding: 15px 20px;
            margin-bottom: 10px;
            cursor: pointer;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .option-item:hover {
            border-color: var(--secondary);
            transform: translateX(5px);
        }

        .option-item.selected {
            border-color: var(--primary);
            background: rgba(27, 44, 39, 0.05);
        }

        .option-item.correct {
            border-color: #28a745;
            background: rgba(40, 167, 69, 0.1);
        }

        .option-item.incorrect {
            border-color: #dc3545;
            background: rgba(220, 53, 69, 0.1);
        }

        .option-letter {
            background: var(--primary);
            color: var(--white);
            width: 30px;
            height: 30px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 600;
            font-size: 0.9rem;
            flex-shrink: 0;
        }

        .option-item.correct .option-letter {
            background: #28a745;
        }

        .option-item.incorrect .option-letter {
            background: #dc3545;
        }

        /* Fill in the blank */
        .fill-blank-input {
            border: 2px solid var(--secondary);
            border-radius: 5px;
            padding: 8px 15px;
            font-size: 1rem;
            min-width: 150px;
            transition: all 0.3s;
        }

        .fill-blank-input:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 3px rgba(27, 44, 39, 0.1);
        }

        .fill-blank-input.correct {
            border-color: #28a745;
            background: rgba(40, 167, 69, 0.1);
        }

        .fill-blank-input.incorrect {
            border-color: #dc3545;
            background: rgba(220, 53, 69, 0.1);
        }

        /* Exercise Actions */
        .exercise-actions {
            display: flex;
            gap: 10px;
            margin-top: 20px;
            flex-wrap: wrap;
        }

        .btn-check {
            background: var(--primary);
            color: var(--white);
            border: none;
            padding: 12px 25px;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s;
        }

        .btn-check:hover {
            background: #2d4942;
            transform: translateY(-2px);
        }

        .btn-hint {
            background: transparent;
            color: var(--primary);
            border: 2px solid var(--primary);
            padding: 12px 25px;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s;
        }

        .btn-hint:hover {
            background: var(--light-bg);
        }

        .feedback-message {
            padding: 15px;
            border-radius: 8px;
            margin-top: 15px;
            display: none;
        }

        .feedback-message.success {
            background: rgba(40, 167, 69, 0.1);
            border: 1px solid #28a745;
            color: #155724;
            display: block;
        }

        .feedback-message.error {
            background: rgba(220, 53, 69, 0.1);
            border: 1px solid #dc3545;
            color: #721c24;
            display: block;
        }

        .feedback-message.hint {
            background: rgba(255, 193, 7, 0.1);
            border: 1px solid #ffc107;
            color: #856404;
            display: block;
        }

        /* Vocabulary Box */
        .vocabulary-box {
            background: linear-gradient(135deg, var(--light-bg), #e8e8e8);
            border-radius: 15px;
            padding: 25px;
            margin: 20px 0;
        }

        .vocabulary-box h4 {
            color: var(--primary);
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .vocab-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 15px;
        }

        .vocab-item {
            background: var(--white);
            padding: 15px;
            border-radius: 10px;
            border-left: 4px solid var(--secondary);
        }

        .vocab-item .term {
            font-weight: 700;
            color: var(--primary);
            margin-bottom: 5px;
            font-size: 1.1rem;
        }

        .vocab-item .definition {
            font-size: 0.9rem;
            color: var(--text-dark);
            line-height: 1.5;
        }

        .vocab-item .spanish {
            font-size: 0.85rem;
            color: var(--text-light);
            font-style: italic;
            margin-top: 5px;
        }

        /* Comparison Table */
        .comparison-table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
            background: var(--white);
            border-radius: 10px;
            overflow: hidden;
            box-shadow: var(--shadow);
        }

        .comparison-table th {
            background: var(--primary);
            color: var(--white);
            padding: 15px;
            text-align: left;
            font-weight: 600;
        }

        .comparison-table td {
            padding: 12px 15px;
            border-bottom: 1px solid var(--light-bg);
        }

        .comparison-table tr:last-child td {
            border-bottom: none;
        }

        .comparison-table tr:hover {
            background: rgba(207, 168, 146, 0.05);
        }

        /* Document Display */
        .document-display {
            background: var(--white);
            border: 2px solid var(--primary);
            border-radius: 10px;
            padding: 30px;
            margin: 20px 0;
            font-family: 'Courier New', monospace;
            font-size: 0.95rem;
            line-height: 1.8;
        }

        .document-display .doc-header {
            text-align: center;
            font-weight: 700;
            font-size: 1.1rem;
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 2px solid var(--primary);
        }

        .document-display .doc-to {
            margin: 15px 0;
        }

        .document-display .doc-section {
            margin: 15px 0;
        }

        /* Progress Bar */
        .progress-bar {
            background: var(--light-bg);
            height: 8px;
            border-radius: 4px;
            margin-bottom: 20px;
            overflow: hidden;
        }

        .progress-fill {
            background: linear-gradient(90deg, var(--secondary), var(--primary));
            height: 100%;
            border-radius: 4px;
            transition: width 0.5s ease;
        }

        /* Module Navigation */
        .module-navigation {
            display: flex;
            justify-content: space-between;
            padding: 20px 0;
            margin-top: 30px;
            border-top: 2px solid var(--light-bg);
            gap: 10px;
        }

        .nav-btn {
            display: flex;
            align-items: center;
            gap: 10px;
            padding: 15px 25px;
            background: var(--white);
            border: 2px solid var(--primary);
            border-radius: 10px;
            text-decoration: none;
            color: var(--primary);
            font-weight: 600;
            transition: all 0.3s;
        }

        .nav-btn:hover {
            background: var(--primary);
            color: var(--white);
        }

        .nav-btn.disabled {
            opacity: 0.5;
            pointer-events: none;
        }

        /* Responsive */
        @media (max-width: 1200px) {
            .module-layout {
                grid-template-columns: 1fr;
            }

            .video-section {
                position: sticky;
                height: 50vh;
                top: 80px;
                z-index: 100;
            }

            .content-section {
                height: auto;
            }
        }

        @media (max-width: 768px) {
            .video-section {
                position: sticky;
                height: 35vh;
                top: 60px;
                z-index: 100;
            }

            /* Ajustar controles de video para m√≥vil */
            .video-controls {
                padding: 10px 15px;
                flex-wrap: wrap;
                transition: all 0.3s ease;
                max-height: 500px;
                overflow-y: auto;
                overflow-x: hidden;
                cursor: pointer;
                -webkit-overflow-scrolling: touch;
            }

            .video-controls::-webkit-scrollbar {
                width: 4px;
            }

            .video-controls::-webkit-scrollbar-track {
                background: rgba(255, 255, 255, 0.1);
            }

            .video-controls::-webkit-scrollbar-thumb {
                background: var(--secondary);
                border-radius: 2px;
            }

            /* Estado colapsado de controles en m√≥vil */
            .video-controls.collapsed {
                max-height: 45px;
                padding: 8px 15px;
                overflow: hidden;
            }

            .video-controls.collapsed .time-markers {
                display: none;
            }

            .video-controls.collapsed::after {
                content: "üìç Tap para ver cap√≠tulos";
                display: block;
                font-size: 0.7rem;
                color: rgba(255, 255, 255, 0.7);
                margin-left: auto;
                white-space: nowrap;
            }

            .video-controls .btn-control {
                flex-shrink: 0;
                margin-bottom: 8px;
                width: 100%;
                max-width: 150px;
            }

            .time-markers {
                gap: 6px;
                transition: opacity 0.3s ease;
                width: 100%;
                max-height: 380px;
                overflow-y: auto;
            }

            .time-marker {
                font-size: 0.7rem;
                padding: 6px 10px;
                white-space: normal;
                line-height: 1.3;
                text-align: left;
                width: 100%;
            }

            .content-section {
                padding: 20px;
            }

            .module-header h1 {
                font-size: 1.4rem;
            }

            .module-meta {
                flex-direction: column;
                gap: 10px;
            }

            .vocab-grid {
                grid-template-columns: 1fr;
            }

            .exercise-actions {
                flex-direction: column;
            }

            .comparison-table {
                font-size: 0.85rem;
            }

            .comparison-table th,
            .comparison-table td {
                padding: 10px;
            }
        }
    </style>
</head>
<body>
    <!-- Header -->
    <header class="header">
        <div class="nav-container">
            <div class="logo-container">
                <a href="../../../../index.html">
                    <img src="../../../../images/logo.png" alt="Cursos Jur√≠dicos Emp√≠rica" class="logo-img" onerror="this.style.display='none'">
                </a>
                <div class="logo-text">
                    <h1>Legal English</h1>
                    <p>Anglo-American Law in Action</p>
                </div>
            </div>
            <button class="mobile-menu-toggle" onclick="toggleMenu()">‚ò∞</button>
            <ul class="nav-menu" id="navMenu">
                <li><a href="../../index.html">Curso</a></li>
                <li><a href="../index.html">M√≥dulos</a></li>
                <li><a href="../../../../contacto.html">Contacto</a></li>
            </ul>
        </div>
    </header>

    <!-- Banner de M√≥dulo Gratis -->
    <div style="background: linear-gradient(135deg, #10B981, #059669); color: white; padding: 20px; text-align: center; box-shadow: 0 4px 15px rgba(16, 185, 129, 0.3); position: relative; z-index: 50;">
        <div style="max-width: 1200px; margin: 0 auto;">
            <p style="margin: 0; font-size: 1.5rem; font-weight: 700; margin-bottom: 8px;">
                üéÅ ¬°M√ìDULO 100% GRATUITO! üéÅ
            </p>
            <p style="margin: 0; font-size: 1rem; opacity: 0.95;">
                Este m√≥dulo completo es <strong>totalmente gratis</strong>. Prueba la calidad del curso sin costo alguno.
            </p>
            <p style="margin: 10px 0 0 0; font-size: 0.9rem; opacity: 0.9;">
                Si te gusta, puedes <a href="../../index.html" style="color: white; text-decoration: underline; font-weight: 600;">inscribirte al curso completo</a> de 15 m√≥dulos.
            </p>
        </div>
    </div>

    <!-- Main Layout -->
    <main class="module-layout">
        <!-- Video Section -->
        <section class="video-section">
            <div class="video-container">
                <div id="videoPlayer"></div>
            </div>
            <div class="video-controls">
                <button class="btn-control" onclick="playPause()">‚èØ Play/Pause</button>
                <div class="time-markers">
                    <span class="time-marker" data-time="0" onclick="seekTo(0)">00:00 - Introducci√≥n al curso</span>
                    <span class="time-marker" data-time="650" onclick="seekTo(650)">10:50 - Parte 1: Vocabulario Legal</span>
                    <span class="time-marker" data-time="1135" onclick="seekTo(1135)">18:55 - Parte 2: Reading - Sistemas Judiciales</span>
                    <span class="time-marker" data-time="2040" onclick="seekTo(2040)">34:00 - Parte 3: Listening - Magistrates' Court</span>
                    <span class="time-marker" data-time="2739" onclick="seekTo(2739)">45:39 - Parte 4: An√°lisis de Documentos</span>
                    <span class="time-marker" data-time="3497" onclick="seekTo(3497)">58:17 - Parte 5: Resumen y Pr√≥ximos Pasos</span>
                </div>
            </div>
        </section>

        <!-- Content Section -->
        <section class="content-section">
            <!-- Progress Bar -->
            <div class="progress-bar">
                <div class="progress-fill" id="progressFill" style="width: 0%"></div>
            </div>

            <!-- Module Header -->
            <div class="module-header">
                <h1>Module 1: US & UK Court Systems</h1>
                <div class="module-meta">
                    <span>üìö Part 1 of 15</span>
                    <span>‚è± 45-60 min</span>
                    <span>üìù 11 exercises</span>
                    <span>üéØ Level: B2</span>
                </div>
            </div>

            <!-- Student Identification -->
            <div class="content-block" style="background: linear-gradient(135deg, #f8f9fa, #e9ecef); border: 2px solid var(--secondary);">
                <h2>üë§ Student Information / Informaci√≥n del Estudiante</h2>
                <p style="margin-bottom: 15px; color: var(--text-light);">Please enter your information before starting the module. This will help us track your progress.</p>
                <p style="margin-bottom: 20px; color: var(--text-light); font-size: 0.9rem;">Por favor ingresa tu informaci√≥n antes de iniciar el m√≥dulo. Esto nos ayudar√° a seguir tu progreso.</p>
                <div style="display: flex; flex-direction: column; gap: 15px; max-width: 600px;">
                    <div>
                        <label for="studentName" style="display: block; font-weight: 600; color: var(--primary); margin-bottom: 8px;">
                            Full Name / Nombre Completo: <span style="color: #dc3545;">*</span>
                        </label>
                        <input
                            type="text"
                            id="studentName"
                            placeholder="Juan P√©rez Garc√≠a"
                            style="width: 100%; padding: 12px; border: 2px solid var(--secondary); border-radius: 8px; font-size: 1rem;"
                            required
                        >
                    </div>
                    <div>
                        <label for="studentEmail" style="display: block; font-weight: 600; color: var(--primary); margin-bottom: 8px;">
                            Email (optional) / Correo electr√≥nico (opcional):
                        </label>
                        <input
                            type="email"
                            id="studentEmail"
                            placeholder="juan@example.com"
                            style="width: 100%; padding: 12px; border: 2px solid var(--secondary); border-radius: 8px; font-size: 1rem;"
                        >
                    </div>
                    <button
                        onclick="saveStudentInfo()"
                        class="btn-check"
                        style="max-width: 200px;"
                    >
                        Save & Start / Guardar
                    </button>
                    <div id="student-info-feedback" style="display: none; padding: 10px; border-radius: 5px; font-size: 0.9rem;"></div>
                </div>
            </div>

            <!-- Learning Objectives -->
            <div class="content-block highlight">
                <h2>üéØ Learning Objectives</h2>
                <p>By the end of this module, you will be able to:</p>
                <ul>
                    <li>Explain the difference between federal and state courts in the US</li>
                    <li>Understand how Magistrates' Courts work in the UK</li>
                    <li>Read and analyze real court documents in English</li>
                    <li>Use essential legal vocabulary with confidence</li>
                    <li>Recognize key differences between common law and civil law systems</li>
                </ul>
            </div>

            <!-- KEY VOCABULARY -->
            <div class="vocabulary-box">
                <h4>üìö Key Vocabulary - Study These Terms</h4>
                <div class="vocab-grid">
                    <div class="vocab-item">
                        <div class="term">court</div>
                        <div class="definition">a place where legal cases are heard and decided</div>
                        <div class="spanish">tribunal, corte</div>
                    </div>
                    <div class="vocab-item">
                        <div class="term">judge</div>
                        <div class="definition">a person who makes decisions in a court of law</div>
                        <div class="spanish">juez</div>
                    </div>
                    <div class="vocab-item">
                        <div class="term">jurisdiction</div>
                        <div class="definition">the official power to make legal decisions</div>
                        <div class="spanish">jurisdicci√≥n, competencia</div>
                    </div>
                    <div class="vocab-item">
                        <div class="term">appeal</div>
                        <div class="definition">to ask a higher court to change a decision</div>
                        <div class="spanish">apelaci√≥n, apelar</div>
                    </div>
                    <div class="vocab-item">
                        <div class="term">magistrate</div>
                        <div class="definition">a judge in a lower court (UK)</div>
                        <div class="spanish">magistrado (juez menor)</div>
                    </div>
                    <div class="vocab-item">
                        <div class="term">trial</div>
                        <div class="definition">a formal examination of evidence in court</div>
                        <div class="spanish">juicio</div>
                    </div>
                    <div class="vocab-item">
                        <div class="term">jury</div>
                        <div class="definition">a group of citizens who decide facts in a trial</div>
                        <div class="spanish">jurado</div>
                    </div>
                    <div class="vocab-item">
                        <div class="term">defendant</div>
                        <div class="definition">a person accused of a crime or sued in court</div>
                        <div class="spanish">demandado, acusado</div>
                    </div>
                    <div class="vocab-item">
                        <div class="term">federal</div>
                        <div class="definition">relating to the national government (US)</div>
                        <div class="spanish">federal</div>
                    </div>
                    <div class="vocab-item">
                        <div class="term">state court</div>
                        <div class="definition">a court that deals with state laws (US)</div>
                        <div class="spanish">tribunal estatal</div>
                    </div>
                    <div class="vocab-item">
                        <div class="term">Supreme Court</div>
                        <div class="definition">the highest court in a legal system</div>
                        <div class="spanish">Corte Suprema</div>
                    </div>
                    <div class="vocab-item">
                        <div class="term">civil case</div>
                        <div class="definition">a legal dispute between individuals or companies</div>
                        <div class="spanish">caso civil</div>
                    </div>
                </div>
            </div>

            <!-- PART 1: VOCABULARY EXERCISES -->

            <!-- Pause Indicator -->
            <div class="pause-indicator" onclick="seekTo(240)">
                <span class="icon">‚è∏</span>
                <div class="text">
                    <strong>Pause the video here</strong>
                    <small>Complete Exercise 1 before continuing (04:00)</small>
                </div>
            </div>

            <!-- Exercise 1: Matching -->
            <div class="exercise-block" id="exercise1">
                <div class="exercise-header">
                    <div class="exercise-number">1</div>
                    <div class="exercise-title">
                        <h3>Matching Exercise</h3>
                        <span>Match the terms (1-10) with their definitions (a-j)</span>
                    </div>
                </div>
                <div class="exercise-content">
                    <p><strong>Click on pairs to match them:</strong></p>
                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin-top: 20px;">
                        <div>
                            <h4 style="color: var(--primary); margin-bottom: 10px;">Terms</h4>
                            <div class="option-item" data-match="d" onclick="selectMatch(this, 'exercise1')">
                                <span class="option-letter">1</span>
                                <span>jurisdiction</span>
                            </div>
                            <div class="option-item" data-match="g" onclick="selectMatch(this, 'exercise1')">
                                <span class="option-letter">2</span>
                                <span>appeal</span>
                            </div>
                            <div class="option-item" data-match="h" onclick="selectMatch(this, 'exercise1')">
                                <span class="option-letter">3</span>
                                <span>magistrate</span>
                            </div>
                            <div class="option-item" data-match="f" onclick="selectMatch(this, 'exercise1')">
                                <span class="option-letter">4</span>
                                <span>trial</span>
                            </div>
                            <div class="option-item" data-match="a" onclick="selectMatch(this, 'exercise1')">
                                <span class="option-letter">5</span>
                                <span>jury</span>
                            </div>
                            <div class="option-item" data-match="c" onclick="selectMatch(this, 'exercise1')">
                                <span class="option-letter">6</span>
                                <span>judge</span>
                            </div>
                            <div class="option-item" data-match="e" onclick="selectMatch(this, 'exercise1')">
                                <span class="option-letter">7</span>
                                <span>federal</span>
                            </div>
                            <div class="option-item" data-match="b" onclick="selectMatch(this, 'exercise1')">
                                <span class="option-letter">8</span>
                                <span>Supreme Court</span>
                            </div>
                            <div class="option-item" data-match="j" onclick="selectMatch(this, 'exercise1')">
                                <span class="option-letter">9</span>
                                <span>defendant</span>
                            </div>
                            <div class="option-item" data-match="i" onclick="selectMatch(this, 'exercise1')">
                                <span class="option-letter">10</span>
                                <span>civil case</span>
                            </div>
                        </div>
                        <div>
                            <h4 style="color: var(--primary); margin-bottom: 10px;">Definitions</h4>
                            <div class="option-item" data-match="a" onclick="selectMatch(this, 'exercise1')">
                                <span class="option-letter">a</span>
                                <span>a group of people who decide if someone is guilty</span>
                            </div>
                            <div class="option-item" data-match="b" onclick="selectMatch(this, 'exercise1')">
                                <span class="option-letter">b</span>
                                <span>the highest court in the legal system</span>
                            </div>
                            <div class="option-item" data-match="c" onclick="selectMatch(this, 'exercise1')">
                                <span class="option-letter">c</span>
                                <span>a person who decides legal cases</span>
                            </div>
                            <div class="option-item" data-match="d" onclick="selectMatch(this, 'exercise1')">
                                <span class="option-letter">d</span>
                                <span>the power to make legal decisions</span>
                            </div>
                            <div class="option-item" data-match="e" onclick="selectMatch(this, 'exercise1')">
                                <span class="option-letter">e</span>
                                <span>relating to national government</span>
                            </div>
                            <div class="option-item" data-match="f" onclick="selectMatch(this, 'exercise1')">
                                <span class="option-letter">f</span>
                                <span>a formal court hearing with evidence</span>
                            </div>
                            <div class="option-item" data-match="g" onclick="selectMatch(this, 'exercise1')">
                                <span class="option-letter">g</span>
                                <span>to ask a higher court to review a decision</span>
                            </div>
                            <div class="option-item" data-match="h" onclick="selectMatch(this, 'exercise1')">
                                <span class="option-letter">h</span>
                                <span>a lower-level judge in the UK</span>
                            </div>
                            <div class="option-item" data-match="i" onclick="selectMatch(this, 'exercise1')">
                                <span class="option-letter">i</span>
                                <span>a dispute about rights, not crimes</span>
                            </div>
                            <div class="option-item" data-match="j" onclick="selectMatch(this, 'exercise1')">
                                <span class="option-letter">j</span>
                                <span>a person accused or sued in court</span>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="exercise-actions">
                    <button class="btn-check" onclick="checkMatching('exercise1')">Check Answers</button>
                </div>
                <div class="feedback-message" id="feedback-exercise1"></div>
            </div>

            <!-- Pause Indicator -->
            <div class="pause-indicator" onclick="seekTo(420)">
                <span class="icon">‚è∏</span>
                <div class="text">
                    <strong>Pause the video here</strong>
                    <small>Complete Exercise 2 before continuing (07:00)</small>
                </div>
            </div>

            <!-- Exercise 2: Gap-fill -->
            <div class="exercise-block" id="exercise2">
                <div class="exercise-header">
                    <div class="exercise-number">2</div>
                    <div class="exercise-title">
                        <h3>Complete the Sentences</h3>
                        <span>Use words from the box to fill in the blanks</span>
                    </div>
                </div>
                <div class="exercise-content">
                    <p><strong>Word Box:</strong> <em>court, appeal, jurisdiction, trial, federal, judge, magistrate</em></p>

                    <div style="line-height: 2.5; margin-top: 20px;">
                        <p>1. In the United States, there are both <input type="text" class="fill-blank-input" data-answer="federal" id="blank2-1" style="width: 120px;"> courts and state courts.</p>

                        <p>2. If you disagree with a decision, you can file an <input type="text" class="fill-blank-input" data-answer="appeal" id="blank2-2" style="width: 120px;"> to a higher court.</p>

                        <p>3. A <input type="text" class="fill-blank-input" data-answer="judge" id="blank2-3" style="width: 120px;"> is a person who presides over a court and makes legal decisions.</p>

                        <p>4. The <input type="text" class="fill-blank-input" data-answer="trial" id="blank2-4" style="width: 120px;"> lasted three weeks before the jury reached a verdict.</p>

                        <p>5. Minor criminal cases in England are heard by a <input type="text" class="fill-blank-input" data-answer="magistrate" id="blank2-5" style="width: 120px;"> in a Magistrates' Court.</p>

                        <p>6. Federal courts have <input type="text" class="fill-blank-input" data-answer="jurisdiction" id="blank2-6" style="width: 120px;"> over cases involving federal law.</p>

                        <p>7. The case will be heard in <input type="text" class="fill-blank-input" data-answer="court" id="blank2-7" style="width: 120px;"> next month.</p>
                    </div>
                </div>
                <div class="exercise-actions">
                    <button class="btn-check" onclick="checkFillBlanks('exercise2', 7)">Check Answers</button>
                </div>
                <div class="feedback-message" id="feedback-exercise2"></div>
            </div>

            <!-- PART 2: READING -->
            <div class="content-block">
                <h2>üìñ Understanding Common Law Court Systems</h2>
                <p>
                    The United States and the United Kingdom both use <strong>common law systems</strong>, but their court structures are different. In the <strong>United States</strong>, there are two separate court systems: <strong>federal courts</strong> and <strong>state courts</strong>. Federal courts deal with cases involving federal law, disputes between states, and cases involving foreign governments. The <strong>Supreme Court of the United States (SCOTUS)</strong> is the highest court in the country. State courts handle most criminal and civil cases, including family law, contracts, and property disputes.
                </p>
                <p>
                    In the <strong>United Kingdom</strong>, the court system is unified but divided by the type of case. <strong>Criminal cases</strong> in England and Wales start in <strong>Magistrates' Courts</strong> for minor offenses or in the <strong>Crown Court</strong> for serious crimes. <strong>Civil cases</strong> begin in <strong>County Courts</strong> or the <strong>High Court</strong> depending on their complexity. The <strong>UK Supreme Court (UKSC)</strong>, established in 2009, is the final court of appeal for the entire UK.
                </p>
                <p>
                    <strong>Mexico</strong> uses a <strong>civil law system</strong>, which is different from common law. However, Mexico has federal and state courts similar to the US. The <strong>Supreme Court of Justice (SCJN)</strong> is the highest court. Understanding Anglo-American court systems helps Mexican lawyers work with international clients and understand case precedents from the US and UK.
                </p>
                <p>
                    <strong>Key difference:</strong> In common law countries, judges' decisions create legal precedents that future courts must follow. In civil law countries like Mexico, written codes are more important than precedents.
                </p>
            </div>

            <!-- Comparative Table -->
            <div class="content-block">
                <h2>üìä Comparative Table</h2>
                <table class="comparison-table">
                    <thead>
                        <tr>
                            <th>Feature</th>
                            <th>United States</th>
                            <th>United Kingdom</th>
                            <th>Mexico</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td><strong>Legal System</strong></td>
                            <td>Common Law</td>
                            <td>Common Law</td>
                            <td>Civil Law</td>
                        </tr>
                        <tr>
                            <td><strong>Highest Court</strong></td>
                            <td>Supreme Court (SCOTUS)</td>
                            <td>UK Supreme Court (UKSC)</td>
                            <td>Supreme Court (SCJN)</td>
                        </tr>
                        <tr>
                            <td><strong>Court Structure</strong></td>
                            <td>Federal + State</td>
                            <td>Unified (by case type)</td>
                            <td>Federal + State</td>
                        </tr>
                        <tr>
                            <td><strong>Criminal Trial Court</strong></td>
                            <td>District Court / State Court</td>
                            <td>Crown Court</td>
                            <td>Federal/State Courts</td>
                        </tr>
                        <tr>
                            <td><strong>Minor Criminal Cases</strong></td>
                            <td>State Courts</td>
                            <td>Magistrates' Court</td>
                            <td>Minor Offenses Courts</td>
                        </tr>
                        <tr>
                            <td><strong>Role of Precedent</strong></td>
                            <td>Very important</td>
                            <td>Very important</td>
                            <td>Less important</td>
                        </tr>
                    </tbody>
                </table>
            </div>

            <!-- Pause Indicator -->
            <div class="pause-indicator" onclick="seekTo(1080)">
                <span class="icon">‚è∏</span>
                <div class="text">
                    <strong>Pause the video here</strong>
                    <small>Complete Exercise 3 before continuing (18:00)</small>
                </div>
            </div>

            <!-- Exercise 3: True or False -->
            <div class="exercise-block" id="exercise3">
                <div class="exercise-header">
                    <div class="exercise-number">3</div>
                    <div class="exercise-title">
                        <h3>True or False</h3>
                        <span>Determine if the statements are correct. If false, correct them.</span>
                    </div>
                </div>
                <div class="exercise-content">
                    <div style="margin-bottom: 20px;">
                        <p><strong>1. The US has only one court system for the entire country.</strong></p>
                        <ul class="options-list">
                            <li class="option-item" data-correct="false" onclick="selectOption(this, 'tf3-1')">
                                <span class="option-letter">T</span>
                                <span>True</span>
                            </li>
                            <li class="option-item" data-correct="true" onclick="selectOption(this, 'tf3-1')">
                                <span class="option-letter">F</span>
                                <span>False</span>
                            </li>
                        </ul>
                    </div>

                    <div style="margin-bottom: 20px;">
                        <p><strong>2. The UK Supreme Court was established in 2009.</strong></p>
                        <ul class="options-list">
                            <li class="option-item" data-correct="true" onclick="selectOption(this, 'tf3-2')">
                                <span class="option-letter">T</span>
                                <span>True</span>
                            </li>
                            <li class="option-item" data-correct="false" onclick="selectOption(this, 'tf3-2')">
                                <span class="option-letter">F</span>
                                <span>False</span>
                            </li>
                        </ul>
                    </div>

                    <div style="margin-bottom: 20px;">
                        <p><strong>3. Mexico uses a common law system like the US and UK.</strong></p>
                        <ul class="options-list">
                            <li class="option-item" data-correct="false" onclick="selectOption(this, 'tf3-3')">
                                <span class="option-letter">T</span>
                                <span>True</span>
                            </li>
                            <li class="option-item" data-correct="true" onclick="selectOption(this, 'tf3-3')">
                                <span class="option-letter">F</span>
                                <span>False</span>
                            </li>
                        </ul>
                    </div>

                    <div style="margin-bottom: 20px;">
                        <p><strong>4. Federal courts in the US deal with cases involving federal law.</strong></p>
                        <ul class="options-list">
                            <li class="option-item" data-correct="true" onclick="selectOption(this, 'tf3-4')">
                                <span class="option-letter">T</span>
                                <span>True</span>
                            </li>
                            <li class="option-item" data-correct="false" onclick="selectOption(this, 'tf3-4')">
                                <span class="option-letter">F</span>
                                <span>False</span>
                            </li>
                        </ul>
                    </div>

                    <div style="margin-bottom: 20px;">
                        <p><strong>5. Magistrates' Courts in the UK handle serious criminal cases.</strong></p>
                        <ul class="options-list">
                            <li class="option-item" data-correct="false" onclick="selectOption(this, 'tf3-5')">
                                <span class="option-letter">T</span>
                                <span>True</span>
                            </li>
                            <li class="option-item" data-correct="true" onclick="selectOption(this, 'tf3-5')">
                                <span class="option-letter">F</span>
                                <span>False</span>
                            </li>
                        </ul>
                    </div>

                    <div style="margin-bottom: 20px;">
                        <p><strong>6. In common law, judges' decisions create precedents.</strong></p>
                        <ul class="options-list">
                            <li class="option-item" data-correct="true" onclick="selectOption(this, 'tf3-6')">
                                <span class="option-letter">T</span>
                                <span>True</span>
                            </li>
                            <li class="option-item" data-correct="false" onclick="selectOption(this, 'tf3-6')">
                                <span class="option-letter">F</span>
                                <span>False</span>
                            </li>
                        </ul>
                    </div>
                </div>
                <div class="exercise-actions">
                    <button class="btn-check" onclick="checkExercise3()">Check Answers</button>
                </div>
                <div class="feedback-message" id="feedback-exercise3"></div>
            </div>

            <!-- Pause Indicator -->
            <div class="pause-indicator" onclick="seekTo(1140)">
                <span class="icon">‚è∏</span>
                <div class="text">
                    <strong>Pause the video here</strong>
                    <small>Complete Exercises 4-5 before continuing (19:00)</small>
                </div>
            </div>

            <!-- Exercise 4: Comprehension Questions -->
            <div class="exercise-block" id="exercise4">
                <div class="exercise-header">
                    <div class="exercise-number">4</div>
                    <div class="exercise-title">
                        <h3>Comprehension Questions</h3>
                        <span>Choose the best answer for each question</span>
                    </div>
                </div>
                <div class="exercise-content">
                    <div style="margin-bottom: 25px;">
                        <p><strong>1. What is the main difference between federal and state courts in the US?</strong></p>
                        <ul class="options-list">
                            <li class="option-item" data-correct="true" onclick="selectOption(this, 'mc4-1')">
                                <span class="option-letter">A</span>
                                <span>Federal courts handle federal law cases, constitutional matters, and disputes between states, while state courts handle state law matters.</span>
                            </li>
                            <li class="option-item" data-correct="false" onclick="selectOption(this, 'mc4-1')">
                                <span class="option-letter">B</span>
                                <span>Federal courts only handle criminal cases, while state courts handle both criminal and civil cases.</span>
                            </li>
                            <li class="option-item" data-correct="false" onclick="selectOption(this, 'mc4-1')">
                                <span class="option-letter">C</span>
                                <span>Federal courts handle cases involving foreign countries, while state courts handle domestic matters exclusively.</span>
                            </li>
                            <li class="option-item" data-correct="false" onclick="selectOption(this, 'mc4-1')">
                                <span class="option-letter">D</span>
                                <span>There is no significant difference; both court systems have identical jurisdiction.</span>
                            </li>
                        </ul>
                    </div>

                    <div style="margin-bottom: 25px;">
                        <p><strong>2. What types of cases do UK Magistrates' Courts handle?</strong></p>
                        <ul class="options-list">
                            <li class="option-item" data-correct="true" onclick="selectOption(this, 'mc4-2')">
                                <span class="option-letter">A</span>
                                <span>Minor criminal cases like traffic offenses, shoplifting, and minor assaults.</span>
                            </li>
                            <li class="option-item" data-correct="false" onclick="selectOption(this, 'mc4-2')">
                                <span class="option-letter">B</span>
                                <span>Serious criminal cases like murder, rape, and robbery.</span>
                            </li>
                            <li class="option-item" data-correct="false" onclick="selectOption(this, 'mc4-2')">
                                <span class="option-letter">C</span>
                                <span>Only civil cases involving property disputes and contract law.</span>
                            </li>
                            <li class="option-item" data-correct="false" onclick="selectOption(this, 'mc4-2')">
                                <span class="option-letter">D</span>
                                <span>Appeals from Crown Court and High Court decisions.</span>
                            </li>
                        </ul>
                    </div>

                    <div style="margin-bottom: 25px;">
                        <p><strong>3. Why is it important for Mexican lawyers to understand Anglo-American court systems?</strong></p>
                        <ul class="options-list">
                            <li class="option-item" data-correct="true" onclick="selectOption(this, 'mc4-3')">
                                <span class="option-letter">A</span>
                                <span>For international business, cross-border legal work, understanding common law precedents, and professional development.</span>
                            </li>
                            <li class="option-item" data-correct="false" onclick="selectOption(this, 'mc4-3')">
                                <span class="option-letter">B</span>
                                <span>Because Mexico is planning to adopt the common law system in the near future.</span>
                            </li>
                            <li class="option-item" data-correct="false" onclick="selectOption(this, 'mc4-3')">
                                <span class="option-letter">C</span>
                                <span>To practice law in the United States without additional qualifications.</span>
                            </li>
                            <li class="option-item" data-correct="false" onclick="selectOption(this, 'mc4-3')">
                                <span class="option-letter">D</span>
                                <span>It's not important; Mexican lawyers only need to know civil law systems.</span>
                            </li>
                        </ul>
                    </div>

                    <div style="margin-bottom: 25px;">
                        <p><strong>4. What is the key difference between common law and civil law regarding precedents?</strong></p>
                        <ul class="options-list">
                            <li class="option-item" data-correct="true" onclick="selectOption(this, 'mc4-4')">
                                <span class="option-letter">A</span>
                                <span>In common law, precedents are binding and guide future decisions. In civil law, precedents are persuasive but not binding.</span>
                            </li>
                            <li class="option-item" data-correct="false" onclick="selectOption(this, 'mc4-4')">
                                <span class="option-letter">B</span>
                                <span>In common law, precedents are only suggestions. In civil law, precedents must always be followed.</span>
                            </li>
                            <li class="option-item" data-correct="false" onclick="selectOption(this, 'mc4-4')">
                                <span class="option-letter">C</span>
                                <span>Common law systems don't use precedents at all, while civil law systems rely entirely on them.</span>
                            </li>
                            <li class="option-item" data-correct="false" onclick="selectOption(this, 'mc4-4')">
                                <span class="option-letter">D</span>
                                <span>Both systems treat precedents exactly the same way with no difference.</span>
                            </li>
                        </ul>
                    </div>
                </div>
                <div class="exercise-actions">
                    <button class="btn-check" onclick="checkExercise4()">Check Answers</button>
                </div>
                <div class="feedback-message" id="feedback-exercise4"></div>
            </div>

            <!-- Exercise 5: Key Vocabulary -->
            <div class="exercise-block" id="exercise5">
                <div class="exercise-header">
                    <div class="exercise-number">5</div>
                    <div class="exercise-title">
                        <h3>Key Vocabulary</h3>
                        <span>Choose the correct legal term for each definition</span>
                    </div>
                </div>
                <div class="exercise-content">
                    <div style="margin-bottom: 25px;">
                        <p><strong>1. A previous court decision that guides future cases:</strong></p>
                        <ul class="options-list">
                            <li class="option-item" data-correct="true" onclick="selectOption(this, 'mc5-1')">
                                <span class="option-letter">A</span>
                                <span>Precedent</span>
                            </li>
                            <li class="option-item" data-correct="false" onclick="selectOption(this, 'mc5-1')">
                                <span class="option-letter">B</span>
                                <span>Statute</span>
                            </li>
                            <li class="option-item" data-correct="false" onclick="selectOption(this, 'mc5-1')">
                                <span class="option-letter">C</span>
                                <span>Verdict</span>
                            </li>
                            <li class="option-item" data-correct="false" onclick="selectOption(this, 'mc5-1')">
                                <span class="option-letter">D</span>
                                <span>Amendment</span>
                            </li>
                        </ul>
                    </div>

                    <div style="margin-bottom: 25px;">
                        <p><strong>2. Laws and disputes involving crimes:</strong></p>
                        <ul class="options-list">
                            <li class="option-item" data-correct="true" onclick="selectOption(this, 'mc5-2')">
                                <span class="option-letter">A</span>
                                <span>Criminal cases</span>
                            </li>
                            <li class="option-item" data-correct="false" onclick="selectOption(this, 'mc5-2')">
                                <span class="option-letter">B</span>
                                <span>Civil cases</span>
                            </li>
                            <li class="option-item" data-correct="false" onclick="selectOption(this, 'mc5-2')">
                                <span class="option-letter">C</span>
                                <span>Administrative cases</span>
                            </li>
                            <li class="option-item" data-correct="false" onclick="selectOption(this, 'mc5-2')">
                                <span class="option-letter">D</span>
                                <span>Constitutional cases</span>
                            </li>
                        </ul>
                    </div>

                    <div style="margin-bottom: 25px;">
                        <p><strong>3. Disagreements about contracts, property, or rights:</strong></p>
                        <ul class="options-list">
                            <li class="option-item" data-correct="true" onclick="selectOption(this, 'mc5-3')">
                                <span class="option-letter">A</span>
                                <span>Civil cases</span>
                            </li>
                            <li class="option-item" data-correct="false" onclick="selectOption(this, 'mc5-3')">
                                <span class="option-letter">B</span>
                                <span>Criminal cases</span>
                            </li>
                            <li class="option-item" data-correct="false" onclick="selectOption(this, 'mc5-3')">
                                <span class="option-letter">C</span>
                                <span>Appellate cases</span>
                            </li>
                            <li class="option-item" data-correct="false" onclick="selectOption(this, 'mc5-3')">
                                <span class="option-letter">D</span>
                                <span>Federal cases</span>
                            </li>
                        </ul>
                    </div>

                    <div style="margin-bottom: 25px;">
                        <p><strong>4. The court that hears the most serious criminal cases in England:</strong></p>
                        <ul class="options-list">
                            <li class="option-item" data-correct="true" onclick="selectOption(this, 'mc5-4')">
                                <span class="option-letter">A</span>
                                <span>Crown Court</span>
                            </li>
                            <li class="option-item" data-correct="false" onclick="selectOption(this, 'mc5-4')">
                                <span class="option-letter">B</span>
                                <span>Magistrates' Court</span>
                            </li>
                            <li class="option-item" data-correct="false" onclick="selectOption(this, 'mc5-4')">
                                <span class="option-letter">C</span>
                                <span>High Court</span>
                            </li>
                            <li class="option-item" data-correct="false" onclick="selectOption(this, 'mc5-4')">
                                <span class="option-letter">D</span>
                                <span>County Court</span>
                            </li>
                        </ul>
                    </div>

                    <div style="margin-bottom: 25px;">
                        <p><strong>5. The final court of appeal in the United States:</strong></p>
                        <ul class="options-list">
                            <li class="option-item" data-correct="true" onclick="selectOption(this, 'mc5-5')">
                                <span class="option-letter">A</span>
                                <span>Supreme Court</span>
                            </li>
                            <li class="option-item" data-correct="false" onclick="selectOption(this, 'mc5-5')">
                                <span class="option-letter">B</span>
                                <span>Court of Appeals</span>
                            </li>
                            <li class="option-item" data-correct="false" onclick="selectOption(this, 'mc5-5')">
                                <span class="option-letter">C</span>
                                <span>District Court</span>
                            </li>
                            <li class="option-item" data-correct="false" onclick="selectOption(this, 'mc5-5')">
                                <span class="option-letter">D</span>
                                <span>Federal Court</span>
                            </li>
                        </ul>
                    </div>
                </div>
                <div class="exercise-actions">
                    <button class="btn-check" onclick="checkExercise5()">Check Answers</button>
                </div>
                <div class="feedback-message" id="feedback-exercise5"></div>
            </div>

            <!-- PART 3: LISTENING -->
            <div class="content-block">
                <h2>üéß A Day in Westminster Magistrates' Court</h2>
                <p><strong>Context:</strong> You will hear Sarah Chen, a court clerk, describing a typical day at a Magistrates' Court in London.</p>

                <!-- Audio Player -->
                <div style="background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%); padding: 25px; border-radius: 15px; margin: 20px 0; border: 2px solid var(--secondary); box-shadow: 0 4px 15px rgba(0,0,0,0.1);">
                    <div style="display: flex; align-items: center; gap: 15px; margin-bottom: 15px;">
                        <span style="font-size: 2rem;">üéß</span>
                        <div style="flex: 1;">
                            <h4 style="margin: 0 0 5px 0; color: var(--primary); font-size: 1.1rem;">Audio: A Day at Westminster Magistrates' Court</h4>
                            <p style="margin: 0; color: #6c757d; font-size: 0.9rem;">Sarah Chen - Court Clerk</p>
                        </div>
                    </div>

                    <audio controls controlsList="nodownload" style="width: 100%; height: 40px; border-radius: 25px; outline: none;">
                        <source src="audio/magistrates-court-sarah-chen.wav" type="audio/wav">
                        Your browser does not support the audio element.
                    </audio>

                    <div style="display: flex; gap: 10px; margin-top: 15px; flex-wrap: wrap;">
                        <button onclick="document.querySelector('audio').currentTime = 0" style="
                            padding: 8px 15px;
                            background: var(--secondary);
                            color: var(--primary);
                            border: none;
                            border-radius: 8px;
                            cursor: pointer;
                            font-weight: 600;
                            font-size: 0.9rem;
                            transition: all 0.3s;
                        " onmouseover="this.style.transform='translateY(-2px)'" onmouseout="this.style.transform='translateY(0)'">
                            ‚èÆÔ∏è Reiniciar
                        </button>
                        <button onclick="document.querySelector('audio').playbackRate = 0.75" style="
                            padding: 8px 15px;
                            background: white;
                            color: var(--primary);
                            border: 2px solid var(--secondary);
                            border-radius: 8px;
                            cursor: pointer;
                            font-weight: 600;
                            font-size: 0.9rem;
                            transition: all 0.3s;
                        " onmouseover="this.style.transform='translateY(-2px)'" onmouseout="this.style.transform='translateY(0)'">
                            üê¢ 0.75x
                        </button>
                        <button onclick="document.querySelector('audio').playbackRate = 1" style="
                            padding: 8px 15px;
                            background: white;
                            color: var(--primary);
                            border: 2px solid var(--secondary);
                            border-radius: 8px;
                            cursor: pointer;
                            font-weight: 600;
                            font-size: 0.9rem;
                            transition: all 0.3s;
                        " onmouseover="this.style.transform='translateY(-2px)'" onmouseout="this.style.transform='translateY(0)'">
                            ‚ñ∂Ô∏è 1x
                        </button>
                        <button onclick="document.querySelector('audio').playbackRate = 1.25" style="
                            padding: 8px 15px;
                            background: white;
                            color: var(--primary);
                            border: 2px solid var(--secondary);
                            border-radius: 8px;
                            cursor: pointer;
                            font-weight: 600;
                            font-size: 0.9rem;
                            transition: all 0.3s;
                        " onmouseover="this.style.transform='translateY(-2px)'" onmouseout="this.style.transform='translateY(0)'">
                            üêá 1.25x
                        </button>
                    </div>
                </div>

                <p style="background: var(--light-bg); padding: 15px; border-radius: 10px; margin: 15px 0;">
                    <strong>Note:</strong> The audio is also embedded in the video lecture at timestamp 27:00. You can use either the audio player above or the video.
                </p>

                <!-- Transcript Box (Collapsible) -->
                <details style="background: #f8f9fa; padding: 20px; border-radius: 10px; margin: 20px 0; border-left: 4px solid var(--secondary);">
                    <summary style="cursor: pointer; font-weight: 600; color: var(--primary); margin-bottom: 15px; user-select: none;">
                        üìÑ Audio Transcript (Click to expand)
                    </summary>
                    <div style="line-height: 1.8; color: #2C3E50; padding: 15px 0;">
                        <p style="margin-bottom: 12px;">"Good morning, I'm Sarah Chen, and I work as a court clerk at Westminster Magistrates' Court in London. Let me tell you about a typical day here.</p>

                        <p style="margin-bottom: 12px;">A typical day starts at 9:00 AM when we open the court. Most people don't realise that magistrates are not professional judges ‚Äì they are trained volunteers from the local community. They receive extensive training, but they usually have other jobs during the week.</p>

                        <p style="margin-bottom: 12px;">We handle minor criminal cases, like traffic offenses, shoplifting, and minor assaults. Each case usually takes about twenty minutes, though some can be longer if there are complications. The defendant can represent themselves or have a lawyer present to advise them.</p>

                        <p style="margin-bottom: 12px;">If the case is more serious than we initially thought, the magistrates can send it to the Crown Court where it will be heard by a professional judge and possibly a jury. We also deal with warrant applications ‚Äì these are requests from police to search property or arrest someone ‚Äì and bail hearings, where we decide if someone can be released while waiting for trial.</p>

                        <p style="margin-bottom: 12px;">It's important to remember that not all cases are completed in one day. Sometimes we need to adjourn the case to another date, perhaps because we need more evidence or witnesses aren't available. The volume of cases is quite high ‚Äì we might see thirty to forty cases in a single day.</p>

                        <p style="margin-bottom: 0;">Working in a Magistrates' Court gives you a real insight into how the justice system works at the community level. It's where most people's only contact with the courts happens."</p>
                    </div>
                </details>
            </div>

            <!-- Pause Indicator -->
            <div class="pause-indicator" onclick="seekTo(1710)">
                <span class="icon">‚è∏</span>
                <div class="text">
                    <strong>Pause the video here</strong>
                    <small>Complete Exercise 6 after listening (28:30)</small>
                </div>
            </div>

            <!-- Exercise 6: Listening Comprehension -->
            <div class="exercise-block" id="exercise6">
                <div class="exercise-header">
                    <div class="exercise-number">6</div>
                    <div class="exercise-title">
                        <h3>Listening Comprehension</h3>
                        <span>Tick (‚úì) the information you hear in the audio</span>
                    </div>
                </div>
                <div class="exercise-content">
                    <p><strong>Listen carefully and select ONLY what Sarah Chen mentions:</strong></p>
                    <ul class="options-list" style="margin-top: 15px;">
                        <li class="option-item" data-correct="true" onclick="toggleCheckbox(this)">
                            <span class="option-letter">‚ñ°</span>
                            <span>The court opens at 9:00 AM</span>
                        </li>
                        <li class="option-item" data-correct="false" onclick="toggleCheckbox(this)">
                            <span class="option-letter">‚ñ°</span>
                            <span>Magistrates are professional judges</span>
                        </li>
                        <li class="option-item" data-correct="true" onclick="toggleCheckbox(this)">
                            <span class="option-letter">‚ñ°</span>
                            <span>Most cases last less than 30 minutes</span>
                        </li>
                        <li class="option-item" data-correct="false" onclick="toggleCheckbox(this)">
                            <span class="option-letter">‚ñ°</span>
                            <span>The court handles divorce cases</span>
                        </li>
                        <li class="option-item" data-correct="true" onclick="toggleCheckbox(this)">
                            <span class="option-letter">‚ñ°</span>
                            <span>Defendants can have a lawyer present</span>
                        </li>
                        <li class="option-item" data-correct="false" onclick="toggleCheckbox(this)">
                            <span class="option-letter">‚ñ°</span>
                            <span>All cases go to trial with a jury</span>
                        </li>
                        <li class="option-item" data-correct="true" onclick="toggleCheckbox(this)">
                            <span class="option-letter">‚ñ°</span>
                            <span>The court deals with traffic offenses</span>
                        </li>
                        <li class="option-item" data-correct="true" onclick="toggleCheckbox(this)">
                            <span class="option-letter">‚ñ°</span>
                            <span>Cases can be adjourned to another date</span>
                        </li>
                    </ul>
                </div>
                <div class="exercise-actions">
                    <button class="btn-check" onclick="checkListening('exercise6')">Check Answers</button>
                </div>
                <div class="feedback-message" id="feedback-exercise6"></div>
            </div>

            <!-- Exercise 7: Listening Gap-fill -->
            <div class="exercise-block" id="exercise7">
                <div class="exercise-header">
                    <div class="exercise-number">7</div>
                    <div class="exercise-title">
                        <h3>Listen and Complete</h3>
                        <span>Fill in the missing words from the audio</span>
                    </div>
                </div>
                <div class="exercise-content">
                    <div style="line-height: 2.2;">
                        <p>"Good morning, I'm Sarah Chen, and I work as a court clerk at Westminster Magistrates' Court. A typical day starts at <input type="text" class="fill-blank-input" data-answer="9:00 am|nine o'clock|9 am|9:00|nine" id="blank7-1" style="width: 120px;"> when we open the court. Most people don't realise that magistrates are not <input type="text" class="fill-blank-input" data-answer="professional" id="blank7-2" style="width: 140px;"> judges ‚Äì they are trained volunteers from the local <input type="text" class="fill-blank-input" data-answer="community" id="blank7-3" style="width: 140px;">.</p>

                        <p>We handle minor criminal cases, like <input type="text" class="fill-blank-input" data-answer="traffic" id="blank7-4" style="width: 120px;"> offenses, shoplifting, and minor assaults. Each case usually takes about <input type="text" class="fill-blank-input" data-answer="20|twenty|20 minutes|twenty minutes" id="blank7-5" style="width: 120px;"> minutes. The defendant can represent themselves or have a <input type="text" class="fill-blank-input" data-answer="lawyer|solicitor" id="blank7-6" style="width: 120px;"> present. If the case is more serious, the magistrates can send it to the <input type="text" class="fill-blank-input" data-answer="crown" id="blank7-7" style="width: 120px;"> Court. We also deal with <input type="text" class="fill-blank-input" data-answer="warrant" id="blank7-8" style="width: 120px;"> applications and bail hearings."</p>
                    </div>
                </div>
                <div class="exercise-actions">
                    <button class="btn-check" onclick="checkFillBlanks('exercise7', 8)">Check Answers</button>
                </div>
                <div class="feedback-message" id="feedback-exercise7"></div>
            </div>

            <!-- Pause Indicator -->
            <div class="pause-indicator" onclick="seekTo(2340)">
                <span class="icon">‚è∏</span>
                <div class="text">
                    <strong>Pause the video here</strong>
                    <small>Complete Exercise 8 before continuing (39:00)</small>
                </div>
            </div>

            <!-- Exercise 8: Match Roles -->
            <div class="exercise-block" id="exercise8">
                <div class="exercise-header">
                    <div class="exercise-number">8</div>
                    <div class="exercise-title">
                        <h3>Court Roles</h3>
                        <span>Match each role with its responsibility</span>
                    </div>
                </div>
                <div class="exercise-content">
                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px;">
                        <div>
                            <h4 style="color: var(--primary); margin-bottom: 10px;">Roles</h4>
                            <div class="option-item" data-match="c" onclick="selectMatch(this, 'exercise8')">
                                <span class="option-letter">1</span>
                                <span>Court Clerk</span>
                            </div>
                            <div class="option-item" data-match="a" onclick="selectMatch(this, 'exercise8')">
                                <span class="option-letter">2</span>
                                <span>Magistrate</span>
                            </div>
                            <div class="option-item" data-match="d" onclick="selectMatch(this, 'exercise8')">
                                <span class="option-letter">3</span>
                                <span>Defense Lawyer</span>
                            </div>
                            <div class="option-item" data-match="b" onclick="selectMatch(this, 'exercise8')">
                                <span class="option-letter">4</span>
                                <span>Prosecutor</span>
                            </div>
                            <div class="option-item" data-match="e" onclick="selectMatch(this, 'exercise8')">
                                <span class="option-letter">5</span>
                                <span>Defendant</span>
                            </div>
                        </div>
                        <div>
                            <h4 style="color: var(--primary); margin-bottom: 10px;">Responsibilities</h4>
                            <div class="option-item" data-match="a" onclick="selectMatch(this, 'exercise8')">
                                <span class="option-letter">a</span>
                                <span>Decides if defendant is guilty or not guilty</span>
                            </div>
                            <div class="option-item" data-match="b" onclick="selectMatch(this, 'exercise8')">
                                <span class="option-letter">b</span>
                                <span>Represents the government in criminal cases</span>
                            </div>
                            <div class="option-item" data-match="c" onclick="selectMatch(this, 'exercise8')">
                                <span class="option-letter">c</span>
                                <span>Manages court administration and records</span>
                            </div>
                            <div class="option-item" data-match="d" onclick="selectMatch(this, 'exercise8')">
                                <span class="option-letter">d</span>
                                <span>Represents the defendant</span>
                            </div>
                            <div class="option-item" data-match="e" onclick="selectMatch(this, 'exercise8')">
                                <span class="option-letter">e</span>
                                <span>The person accused of a crime</span>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="exercise-actions">
                    <button class="btn-check" onclick="checkMatching('exercise8')">Check Answers</button>
                </div>
                <div class="feedback-message" id="feedback-exercise8"></div>
            </div>

            <!-- PART 4: PRACTICAL APPLICATION -->
            <div class="content-block">
                <h2>üìÑ Document Analysis: Court Summons</h2>
                <p>Read this extract from a real UK Magistrates' Court summons:</p>
            </div>

            <div class="document-display">
                <div class="doc-header">
                    WESTMINSTER MAGISTRATES' COURT<br>
                    Marylebone Road, London NW1 5TR<br><br>
                    SUMMONS TO ATTEND COURT
                </div>

                <div class="doc-to">
                    To: James Robert Thompson<br>
                    &nbsp;&nbsp;&nbsp;&nbsp;15 Victoria Street, London SW1
                </div>

                <div class="doc-section">
                    You are summoned to appear before Westminster Magistrates' Court<br>
                    on <strong>Monday, 4th December 2024 at 10:00 AM</strong>
                </div>

                <div class="doc-section">
                    <strong>Offense:</strong> Driving without due care and attention<br>
                    <strong>Date of Offense:</strong> 15th September 2024<br>
                    <strong>Location:</strong> Oxford Street, London W1
                </div>

                <div class="doc-section">
                    You must attend court on the date shown above. If you fail to attend,<br>
                    a warrant may be issued for your arrest. You may be represented by<br>
                    a solicitor or legal representative.
                </div>

                <div class="doc-section" style="margin-top: 20px;">
                    <strong>Issued by:</strong> Court Administration Office<br>
                    <strong>Date:</strong> 15th November 2024
                </div>
            </div>

            <!-- Pause Indicator -->
            <div class="pause-indicator" onclick="seekTo(2760)">
                <span class="icon">‚è∏</span>
                <div class="text">
                    <strong>Pause the video here</strong>
                    <small>Complete Exercises 9-10 before continuing (46:00)</small>
                </div>
            </div>

            <!-- Exercise 9-10: Document Analysis -->
            <div class="exercise-block" id="exercise9">
                <div class="exercise-header">
                    <div class="exercise-number">9-10</div>
                    <div class="exercise-title">
                        <h3>Document Analysis</h3>
                        <span>Answer questions about the court summons</span>
                    </div>
                </div>
                <div class="exercise-content">
                    <div style="line-height: 2.2;">
                        <p><strong>1.</strong> The name of the court:
                        <input type="text" class="fill-blank-input" data-answer="westminster magistrates' court|westminster magistrates court" id="blank9-1" style="width: 300px;"></p>

                        <p><strong>2.</strong> The date of the hearing:
                        <input type="text" class="fill-blank-input" data-answer="monday, 4th december 2024|4th december 2024|monday 4th december 2024|december 4, 2024" id="blank9-2" style="width: 300px;"></p>

                        <p><strong>3.</strong> The offense charged:
                        <input type="text" class="fill-blank-input" data-answer="driving without due care and attention|driving without due care" id="blank9-3" style="width: 350px;"></p>

                        <p><strong>4.</strong> The defendant's name:
                        <input type="text" class="fill-blank-input" data-answer="james robert thompson|james thompson" id="blank9-4" style="width: 300px;"></p>

                        <p><strong>5.</strong> What happens if the defendant doesn't attend:
                        <input type="text" class="fill-blank-input" data-answer="a warrant may be issued|warrant for arrest|a warrant may be issued for his arrest" id="blank9-5" style="width: 400px;"></p>

                        <p><strong>6.</strong> Can the defendant have a lawyer?
                        <select class="fill-blank-input" data-answer="yes" id="blank9-6" style="width: 100px; padding: 8px;">
                            <option value="">Select...</option>
                            <option value="yes">YES</option>
                            <option value="no">NO</option>
                        </select>
                        </p>
                    </div>
                </div>
                <div class="exercise-actions">
                    <button class="btn-check" onclick="checkFillBlanks('exercise9', 6)">Check Answers</button>
                </div>
                <div class="feedback-message" id="feedback-exercise9"></div>
            </div>

            <!-- LATIN TERMS -->
            <div class="vocabulary-box">
                <h4>‚öñÔ∏è Legal Latin Terms</h4>
                <p style="margin-bottom: 15px;">Common Latin phrases used in Anglo-American courts:</p>
                <div class="vocab-grid">
                    <div class="vocab-item">
                        <div class="term">mens rea</div>
                        <div class="definition">guilty mind (criminal intent)</div>
                        <div class="spanish">intenci√≥n criminal</div>
                    </div>
                    <div class="vocab-item">
                        <div class="term">actus reus</div>
                        <div class="definition">guilty act (criminal action)</div>
                        <div class="spanish">acto criminal</div>
                    </div>
                    <div class="vocab-item">
                        <div class="term">habeas corpus</div>
                        <div class="definition">you must have the body (right to trial)</div>
                        <div class="spanish">derecho a comparecer ante juez</div>
                    </div>
                    <div class="vocab-item">
                        <div class="term">in camera</div>
                        <div class="definition">in private (closed court session)</div>
                        <div class="spanish">en privado, sesi√≥n cerrada</div>
                    </div>
                    <div class="vocab-item">
                        <div class="term">pro bono</div>
                        <div class="definition">for the public good (free legal work)</div>
                        <div class="spanish">servicio legal gratuito</div>
                    </div>
                    <div class="vocab-item">
                        <div class="term">de facto</div>
                        <div class="definition">in fact (in reality)</div>
                        <div class="spanish">de hecho, en la pr√°ctica</div>
                    </div>
                </div>
            </div>

            <!-- Exercise 11: Latin Terms -->
            <div class="exercise-block" id="exercise11">
                <div class="exercise-header">
                    <div class="exercise-number">11</div>
                    <div class="exercise-title">
                        <h3>Latin Legal Terms</h3>
                        <span>Match the Latin terms with their English meanings</span>
                    </div>
                </div>
                <div class="exercise-content">
                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px;">
                        <div>
                            <h4 style="color: var(--primary); margin-bottom: 10px;">Latin Terms</h4>
                            <div class="option-item" data-match="b" onclick="selectMatch(this, 'exercise11')">
                                <span class="option-letter">1</span>
                                <span>mens rea</span>
                            </div>
                            <div class="option-item" data-match="e" onclick="selectMatch(this, 'exercise11')">
                                <span class="option-letter">2</span>
                                <span>actus reus</span>
                            </div>
                            <div class="option-item" data-match="d" onclick="selectMatch(this, 'exercise11')">
                                <span class="option-letter">3</span>
                                <span>habeas corpus</span>
                            </div>
                            <div class="option-item" data-match="f" onclick="selectMatch(this, 'exercise11')">
                                <span class="option-letter">4</span>
                                <span>in camera</span>
                            </div>
                            <div class="option-item" data-match="a" onclick="selectMatch(this, 'exercise11')">
                                <span class="option-letter">5</span>
                                <span>pro bono</span>
                            </div>
                            <div class="option-item" data-match="c" onclick="selectMatch(this, 'exercise11')">
                                <span class="option-letter">6</span>
                                <span>de facto</span>
                            </div>
                        </div>
                        <div>
                            <h4 style="color: var(--primary); margin-bottom: 10px;">English Meanings</h4>
                            <div class="option-item" data-match="a" onclick="selectMatch(this, 'exercise11')">
                                <span class="option-letter">a</span>
                                <span>free legal services</span>
                            </div>
                            <div class="option-item" data-match="b" onclick="selectMatch(this, 'exercise11')">
                                <span class="option-letter">b</span>
                                <span>criminal intent</span>
                            </div>
                            <div class="option-item" data-match="c" onclick="selectMatch(this, 'exercise11')">
                                <span class="option-letter">c</span>
                                <span>in reality</span>
                            </div>
                            <div class="option-item" data-match="d" onclick="selectMatch(this, 'exercise11')">
                                <span class="option-letter">d</span>
                                <span>right to appear before a judge</span>
                            </div>
                            <div class="option-item" data-match="e" onclick="selectMatch(this, 'exercise11')">
                                <span class="option-letter">e</span>
                                <span>criminal action</span>
                            </div>
                            <div class="option-item" data-match="f" onclick="selectMatch(this, 'exercise11')">
                                <span class="option-letter">f</span>
                                <span>in private court session</span>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="exercise-actions">
                    <button class="btn-check" onclick="checkMatching('exercise11')">Check Answers</button>
                </div>
                <div class="feedback-message" id="feedback-exercise11"></div>
            </div>

            <!-- Summary -->
            <div class="content-block highlight">
                <h2>üìã Module Summary</h2>
                <p>In this module, you learned:</p>
                <ul>
                    <li>The US has two court systems: federal courts and state courts</li>
                    <li>The UK Supreme Court was established in 2009</li>
                    <li>Magistrates in the UK are trained volunteers from the community</li>
                    <li>Common law systems rely on precedents; civil law systems rely on codes</li>
                    <li>How to read and analyze authentic court documents</li>
                    <li>Essential legal vocabulary and Latin terms used in Anglo-American courts</li>
                </ul>
                <p style="margin-top: 15px; padding: 15px; background: rgba(207, 168, 146, 0.1); border-left: 4px solid var(--secondary); border-radius: 5px;">
                    <strong>üìß Submit Your Work:</strong> Email your completed exercises and reflection questions to <strong>jorge_clemente@empirica.mx</strong> for personalized feedback!
                </p>
            </div>

            <!-- CTA: Upgrade to Full Course -->
            <div style="
                background: linear-gradient(135deg, #1B2C27 0%, #2D4A3E 100%);
                border-radius: 20px;
                padding: 50px 40px;
                margin: 40px 0;
                text-align: center;
                box-shadow: 0 20px 60px rgba(0, 0, 0, 0.2);
                color: white;
            ">
                <div style="font-size: 3.5rem; margin-bottom: 20px;">üéì</div>
                <h2 style="font-size: 2.2rem; margin: 0 0 15px 0; font-weight: 700; color: white;">
                    ¬øTe gust√≥ el M√≥dulo 1?
                </h2>
                <p style="font-size: 1.2rem; margin: 0 0 30px 0; opacity: 0.9; max-width: 600px; margin-left: auto; margin-right: auto;">
                    Accede al curso completo con <strong>15 m√≥dulos</strong> de contenido profesional
                </p>

                <!-- Beneficios -->
                <div style="
                    background: rgba(255, 255, 255, 0.1);
                    border-radius: 15px;
                    padding: 30px;
                    margin-bottom: 30px;
                    text-align: left;
                    max-width: 700px;
                    margin-left: auto;
                    margin-right: auto;
                ">
                    <h3 style="color: #10B981; margin: 0 0 20px 0; font-size: 1.3rem; text-align: center;">
                        ‚ú® Al inscribirte al curso completo obtendr√°s:
                    </h3>
                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px;">
                        <div style="display: flex; align-items: start; gap: 10px;">
                            <span style="color: #10B981; font-size: 1.2rem;">‚úì</span>
                            <span>15 m√≥dulos completos de Legal English</span>
                        </div>
                        <div style="display: flex; align-items: start; gap: 10px;">
                            <span style="color: #10B981; font-size: 1.2rem;">‚úì</span>
                            <span>Videos, ejercicios y materiales descargables</span>
                        </div>
                        <div style="display: flex; align-items: start; gap: 10px;">
                            <span style="color: #10B981; font-size: 1.2rem;">‚úì</span>
                            <span>Certificado oficial con firma electr√≥nica SAT</span>
                        </div>
                        <div style="display: flex; align-items: start; gap: 10px;">
                            <span style="color: #10B981; font-size: 1.2rem;">‚úì</span>
                            <span>Soporte personalizado por WhatsApp</span>
                        </div>
                        <div style="display: flex; align-items: start; gap: 10px;">
                            <span style="color: #10B981; font-size: 1.2rem;">‚úì</span>
                            <span>Acceso ilimitado de por vida</span>
                        </div>
                        <div style="display: flex; align-items: start; gap: 10px;">
                            <span style="color: #10B981; font-size: 1.2rem;">‚úì</span>
                            <span>Actualizaciones y nuevo contenido gratis</span>
                        </div>
                    </div>
                </div>

                <!-- Precio y CTA -->
                <div style="margin-bottom: 20px;">
                    <div style="font-size: 1rem; opacity: 0.8; margin-bottom: 10px;">Inversi√≥n √∫nica</div>
                    <div style="font-size: 3rem; font-weight: 700; color: #10B981; margin-bottom: 10px;">
                        $5,000 MXN
                    </div>
                    <div style="font-size: 0.9rem; opacity: 0.7;">
                        Pago √∫nico ‚Ä¢ Sin mensualidades ‚Ä¢ Acceso de por vida
                    </div>
                </div>

                <a href="https://buy.stripe.com/14AeVe3yvbH95p18yQ7EQ01" target="_blank" style="
                    display: inline-block;
                    padding: 20px 50px;
                    background: linear-gradient(135deg, #10B981 0%, #059669 100%);
                    color: white;
                    border: none;
                    border-radius: 15px;
                    font-size: 1.3rem;
                    font-weight: 700;
                    text-decoration: none;
                    cursor: pointer;
                    transition: all 0.3s ease;
                    box-shadow: 0 8px 25px rgba(16, 185, 129, 0.4);
                    margin-bottom: 20px;
                " onmouseover="this.style.transform='translateY(-3px)'; this.style.boxShadow='0 12px 35px rgba(16, 185, 129, 0.5)'"
                   onmouseout="this.style.transform='translateY(0)'; this.style.boxShadow='0 8px 25px rgba(16, 185, 129, 0.4)'">
                    üí≥ Inscribirme al Curso Completo
                </a>

                <div style="margin-top: 20px;">
                    <a href="https://wa.me/529982570828?text=Hola,%20me%20interesa%20el%20curso%20completo%20de%20Legal%20English"
                       target="_blank"
                       style="color: #10B981; text-decoration: underline; font-size: 1rem;">
                        üì± ¬øTienes dudas? Contacta por WhatsApp
                    </a>
                </div>
            </div>

            <!-- Module Evaluation Survey -->
            <div class="exercise-block" id="moduleSurvey" style="background: linear-gradient(135deg, #f8f9fa, #e9ecef); border: 2px solid var(--primary);">
                <div class="exercise-header">
                    <div class="exercise-number">üìä</div>
                    <div class="exercise-title">
                        <h3>Module Evaluation / Evaluaci√≥n del M√≥dulo</h3>
                        <span>Help us improve this course by sharing your feedback</span>
                    </div>
                </div>
                <div class="exercise-content">
                    <form id="surveyForm" style="display: flex; flex-direction: column; gap: 20px;">
                        <!-- Question 1: Difficulty -->
                        <div style="padding: 15px; background: white; border-radius: 10px;">
                            <label style="font-weight: 600; color: var(--primary); display: block; margin-bottom: 10px;">
                                1. How would you rate the difficulty level of this module?<br>
                                <span style="font-size: 0.9rem; color: var(--text-light);">¬øC√≥mo calificar√≠as el nivel de dificultad de este m√≥dulo?</span>
                            </label>
                            <div style="display: flex; flex-direction: column; gap: 8px; margin-top: 10px;">
                                <label style="display: flex; align-items: center; gap: 10px; cursor: pointer;">
                                    <input type="radio" name="difficulty" value="too_easy" required>
                                    <span>Too easy / Muy f√°cil</span>
                                </label>
                                <label style="display: flex; align-items: center; gap: 10px; cursor: pointer;">
                                    <input type="radio" name="difficulty" value="appropriate" required>
                                    <span>Appropriate / Apropiado</span>
                                </label>
                                <label style="display: flex; align-items: center; gap: 10px; cursor: pointer;">
                                    <input type="radio" name="difficulty" value="challenging" required>
                                    <span>Challenging but manageable / Desafiante pero manejable</span>
                                </label>
                                <label style="display: flex; align-items: center; gap: 10px; cursor: pointer;">
                                    <input type="radio" name="difficulty" value="too_hard" required>
                                    <span>Too difficult / Muy dif√≠cil</span>
                                </label>
                            </div>
                        </div>

                        <!-- Question 2: Content Quality -->
                        <div style="padding: 15px; background: white; border-radius: 10px;">
                            <label style="font-weight: 600; color: var(--primary); display: block; margin-bottom: 10px;">
                                2. Rate the quality of the content (1-5 stars)<br>
                                <span style="font-size: 0.9rem; color: var(--text-light);">Califica la calidad del contenido (1-5 estrellas)</span>
                            </label>
                            <div style="display: flex; gap: 10px; margin-top: 10px;">
                                <label style="cursor: pointer;"><input type="radio" name="quality" value="1" required> 1‚≠ê</label>
                                <label style="cursor: pointer;"><input type="radio" name="quality" value="2" required> 2‚≠ê</label>
                                <label style="cursor: pointer;"><input type="radio" name="quality" value="3" required> 3‚≠ê</label>
                                <label style="cursor: pointer;"><input type="radio" name="quality" value="4" required> 4‚≠ê</label>
                                <label style="cursor: pointer;"><input type="radio" name="quality" value="5" required> 5‚≠ê</label>
                            </div>
                        </div>

                        <!-- Question 3: Most Useful -->
                        <div style="padding: 15px; background: white; border-radius: 10px;">
                            <label style="font-weight: 600; color: var(--primary); display: block; margin-bottom: 10px;">
                                3. What was the most useful part of this module?<br>
                                <span style="font-size: 0.9rem; color: var(--text-light);">¬øCu√°l fue la parte m√°s √∫til de este m√≥dulo?</span>
                            </label>
                            <textarea name="most_useful" rows="3" style="width: 100%; padding: 10px; border: 2px solid var(--light-bg); border-radius: 8px; font-family: inherit; font-size: 0.95rem;" placeholder="Your answer / Tu respuesta..."></textarea>
                        </div>

                        <!-- Question 4: Suggestions -->
                        <div style="padding: 15px; background: white; border-radius: 10px;">
                            <label style="font-weight: 600; color: var(--primary); display: block; margin-bottom: 10px;">
                                4. Any suggestions for improvement?<br>
                                <span style="font-size: 0.9rem; color: var(--text-light);">¬øAlguna sugerencia de mejora?</span>
                            </label>
                            <textarea name="suggestions" rows="3" style="width: 100%; padding: 10px; border: 2px solid var(--light-bg); border-radius: 8px; font-family: inherit; font-size: 0.95rem;" placeholder="Your suggestions / Tus sugerencias..."></textarea>
                        </div>

                        <!-- Question 5: Time Spent -->
                        <div style="padding: 15px; background: white; border-radius: 10px;">
                            <label style="font-weight: 600; color: var(--primary); display: block; margin-bottom: 10px;">
                                5. How long did it take you to complete this module?<br>
                                <span style="font-size: 0.9rem; color: var(--text-light);">¬øCu√°nto tiempo te tom√≥ completar este m√≥dulo?</span>
                            </label>
                            <select name="time_spent" required style="width: 100%; padding: 10px; border: 2px solid var(--light-bg); border-radius: 8px; font-size: 0.95rem;">
                                <option value="">Select... / Selecciona...</option>
                                <option value="less_30">Less than 30 minutes / Menos de 30 minutos</option>
                                <option value="30_45">30-45 minutes / 30-45 minutos</option>
                                <option value="45_60">45-60 minutes / 45-60 minutos</option>
                                <option value="60_90">60-90 minutes / 60-90 minutos</option>
                                <option value="more_90">More than 90 minutes / M√°s de 90 minutos</option>
                            </select>
                        </div>

                        <!-- Submit Button -->
                        <div style="display: flex; gap: 10px;">
                            <button type="submit" class="btn-check" style="flex: 1;">
                                Submit Survey / Enviar Encuesta
                            </button>
                        </div>
                    </form>
                    <div class="feedback-message" id="feedback-survey"></div>
                </div>
            </div>

            <!-- Module Navigation -->
            <div class="module-navigation">
                <a href="../index.html" class="nav-btn">
                    ‚Üê Back to Modules
                </a>
                <a href="../modulo-2/index.html" class="nav-btn">
                    Next Module ‚Üí
                </a>
            </div>
        </section>
    </main>

    <!-- Email Contact Float -->
    <a href="mailto:jorge_clemente@empirica.mx?subject=Consulta sobre M√≥dulo 1 - Legal English&body=Hola, tengo una pregunta sobre el M√≥dulo 1 de Legal English:%0D%0A%0D%0A"
       class="whatsapp-float" target="_blank" title="¬øDudas? Cont√°ctanos por email">
        üìß
    </a>

    <script>
        // ============================================
        // VIDEO CONTROL FUNCTIONS
        // ============================================

        let player;

        function playPause() {
            if (player && player.getPlayerState) {
                const state = player.getPlayerState();
                if (state === 1) {
                    player.pauseVideo();
                } else {
                    player.playVideo();
                }
            } else {
                alert('Configure your video player to enable controls');
            }
        }

        function seekTo(seconds) {
            if (player && player.seekTo) {
                player.seekTo(seconds, true);
                player.playVideo();
            }
            // Highlight the active time marker
            document.querySelectorAll('.time-marker').forEach(marker => {
                marker.classList.remove('active');
                if (parseInt(marker.dataset.time) === seconds) {
                    marker.classList.add('active');
                }
            });
        }

        function updateProgress() {
            if (player && player.getCurrentTime && player.getDuration) {
                const current = player.getCurrentTime();
                const duration = player.getDuration();
                const progress = (current / duration) * 100;
                document.getElementById('progressFill').style.width = progress + '%';
            }
        }

        // ============================================
        // MOBILE VIDEO CONTROLS COLLAPSE/EXPAND
        // ============================================

        let lastScrollY = 0;
        let scrollTimeout;
        let isExpanded = true;

        function isMobileDevice() {
            return window.innerWidth <= 768;
        }

        function collapseVideoControls() {
            const videoControls = document.querySelector('.video-controls');
            if (videoControls && isMobileDevice()) {
                videoControls.classList.add('collapsed');
                isExpanded = false;
            }
        }

        function expandVideoControls() {
            const videoControls = document.querySelector('.video-controls');
            if (videoControls && isMobileDevice()) {
                videoControls.classList.remove('collapsed');
                isExpanded = true;
            }
        }

        function toggleVideoControls(event) {
            // Only allow toggle on mobile
            if (!isMobileDevice()) return;

            // Don't toggle if clicking on a button or time marker
            if (event.target.classList.contains('btn-control') ||
                event.target.classList.contains('time-marker')) {
                return;
            }

            if (isExpanded) {
                collapseVideoControls();
            } else {
                expandVideoControls();
            }
        }

        // Detect scroll and collapse controls on mobile
        function handleScroll() {
            if (!isMobileDevice()) return;

            const currentScrollY = window.scrollY || window.pageYOffset;

            // If scrolling down and controls are expanded, collapse them
            if (currentScrollY > lastScrollY && isExpanded && currentScrollY > 100) {
                collapseVideoControls();
            }

            lastScrollY = currentScrollY;

            // Clear any existing timeout
            clearTimeout(scrollTimeout);

            // If user stops scrolling and controls are expanded, wait a bit before allowing collapse again
            scrollTimeout = setTimeout(() => {
                // This ensures the collapse state persists after scrolling stops
            }, 150);
        }

        // Initialize mobile controls behavior
        window.addEventListener('DOMContentLoaded', function() {
            const videoControls = document.querySelector('.video-controls');

            if (videoControls) {
                // Add touch/click handler to toggle controls
                videoControls.addEventListener('click', toggleVideoControls);

                // Add scroll listener for mobile
                window.addEventListener('scroll', handleScroll, { passive: true });

                // Collapse controls initially on mobile after a short delay
                if (isMobileDevice()) {
                    setTimeout(() => {
                        collapseVideoControls();
                    }, 3000); // Collapse after 3 seconds
                }
            }

            // Re-check on window resize
            window.addEventListener('resize', function() {
                if (!isMobileDevice() && !isExpanded) {
                    expandVideoControls();
                }
            });
        });

        // ============================================
        // EXERCISE FUNCTIONS
        // ============================================
        // MATCHING EXERCISES - SISTEMA SIMPLIFICADO Y ROBUSTO
        // ============================================

        // Estado global para ejercicios de matching
        const matchingExercises = {};

        // Inicializar ejercicio de matching
        function initMatchingExercise(exerciseId) {
            if (!matchingExercises[exerciseId]) {
                matchingExercises[exerciseId] = {
                    selectedLeft: null,
                    selectedRight: null,
                    pairs: [],
                    pairCounter: 0,
                    isLocked: false
                };
            }
            return matchingExercises[exerciseId];
        }

        // Funci√≥n principal para seleccionar elementos en matching
        function selectMatch(element, exerciseId) {
            console.log('üñ±Ô∏è selectMatch called:', exerciseId, element.textContent.trim().substring(0, 30));

            // Verificar que el ejercicio existe
            const exercise = document.getElementById(exerciseId);
            if (!exercise) {
                console.error('Exercise not found:', exerciseId);
                return;
            }

            // Inicializar estado
            const state = initMatchingExercise(exerciseId);

            // Si el ejercicio est√° bloqueado, no hacer nada
            if (state.isLocked) {
                console.log('Exercise is locked');
                return;
            }

            // Verificar si ya est√° completado en localStorage
            const savedState = loadExerciseState(exerciseId);
            if (savedState && savedState.completed) {
                console.log('Exercise already completed');
                state.isLocked = true;
                return;
            }

            // Si el elemento ya tiene clases de resultado, no permitir cambios
            if (element.classList.contains('correct') || element.classList.contains('incorrect')) {
                return;
            }

            // Si el elemento est√° emparejado, desemparejarlo
            if (element.dataset.paired) {
                unpairMatch(element, exerciseId);
                return;
            }

            // Obtener todos los elementos del ejercicio
            const allItems = Array.from(exercise.querySelectorAll('[data-match]'));
            const midpoint = allItems.length / 2;
            const itemIndex = allItems.indexOf(element);

            // Determinar si es columna izquierda o derecha
            const isLeft = itemIndex < midpoint;

            if (isLeft) {
                // Deseleccionar anterior izquierdo
                if (state.selectedLeft && state.selectedLeft !== element) {
                    state.selectedLeft.classList.remove('selected');
                    state.selectedLeft.style.backgroundColor = '';
                    state.selectedLeft.style.border = '';
                }
                // Seleccionar nuevo
                state.selectedLeft = element;
                element.classList.add('selected');
                element.style.backgroundColor = '#fff3cd';
                element.style.border = '2px solid #ffc107';
            } else {
                // Deseleccionar anterior derecho
                if (state.selectedRight && state.selectedRight !== element) {
                    state.selectedRight.classList.remove('selected');
                    state.selectedRight.style.backgroundColor = '';
                    state.selectedRight.style.border = '';
                }
                // Seleccionar nuevo
                state.selectedRight = element;
                element.classList.add('selected');
                element.style.backgroundColor = '#fff3cd';
                element.style.border = '2px solid #ffc107';
            }

            // Si ambos est√°n seleccionados, crear par
            if (state.selectedLeft && state.selectedRight) {
                createPair(state.selectedLeft, state.selectedRight, exerciseId);
            }
        }

        // Crear un par de elementos emparejados
        function createPair(leftElement, rightElement, exerciseId) {
            const state = matchingExercises[exerciseId];
            state.pairCounter++;
            const pairId = `${exerciseId}-pair-${state.pairCounter}`;

            console.log('‚ú® Creating pair:', pairId);

            // Marcar como emparejados
            leftElement.dataset.paired = pairId;
            rightElement.dataset.paired = pairId;

            // Estilo visual para elementos emparejados
            leftElement.classList.remove('selected');
            rightElement.classList.remove('selected');
            leftElement.classList.add('paired');
            rightElement.classList.add('paired');

            leftElement.style.backgroundColor = '#e9ecef';
            rightElement.style.backgroundColor = '#e9ecef';
            leftElement.style.border = '2px solid #6c757d';
            rightElement.style.border = '2px solid #6c757d';
            leftElement.title = 'Click para deshacer';
            rightElement.title = 'Click para deshacer';

            // Guardar el par
            state.pairs.push({
                pairId: pairId,
                leftElement: leftElement,
                rightElement: rightElement,
                leftMatch: leftElement.dataset.match,
                rightMatch: rightElement.dataset.match,
                leftText: leftElement.textContent.trim(),
                rightText: rightElement.textContent.trim()
            });

            // Limpiar selecciones
            state.selectedLeft = null;
            state.selectedRight = null;

            console.log('Total pairs:', state.pairs.length);
        }

        // Desemparejar elementos
        function unpairMatch(element, exerciseId) {
            const state = matchingExercises[exerciseId];
            if (!state) return;

            const pairId = element.dataset.paired;
            if (!pairId) return;

            const pairIndex = state.pairs.findIndex(p => p.pairId === pairId);
            if (pairIndex === -1) return;

            const pair = state.pairs[pairIndex];
            console.log('‚ôªÔ∏è Unpairing:', pairId);

            // Resetear estado visual
            [pair.leftElement, pair.rightElement].forEach(elem => {
                delete elem.dataset.paired;
                elem.classList.remove('paired', 'selected');
                elem.style.backgroundColor = '';
                elem.style.border = '';
                elem.title = '';
            });

            // Remover del array
            state.pairs.splice(pairIndex, 1);
        }

        // Verificar ejercicio de matching
        function checkMatching(exerciseId) {
            console.log('üîç checkMatching called:', exerciseId);

            const exercise = document.getElementById(exerciseId);
            if (!exercise) {
                console.error('Exercise not found:', exerciseId);
                return;
            }

            const feedback = document.getElementById('feedback-' + exerciseId);
            if (!feedback) {
                console.error('Feedback not found for:', exerciseId);
                return;
            }

            // Inicializar estado si no existe
            const state = initMatchingExercise(exerciseId);

            // Verificar si ya est√° completado
            if (state.isLocked) {
                feedback.textContent = 'Este ejercicio ya fue completado.';
                feedback.className = 'feedback-message error';
                feedback.style.display = 'block';
                return;
            }

            // Contar pares esperados
            const allItems = exercise.querySelectorAll('[data-match]');
            const totalPairs = allItems.length / 2;
            const userPairs = state.pairs || [];

            console.log('Pairs:', userPairs.length, '/', totalPairs);

            // Verificar que todos los pares est√©n hechos
            if (userPairs.length < totalPairs) {
                feedback.className = 'feedback-message error';
                feedback.textContent = `‚ö†Ô∏è Completa todos los pares. Tienes ${userPairs.length}/${totalPairs}.`;
                feedback.style.display = 'block';
                return;
            }

            // Evaluar respuestas
            let correctCount = 0;
            const results = [];

            userPairs.forEach(pair => {
                const isCorrect = pair.leftMatch === pair.rightMatch;
                if (isCorrect) correctCount++;

                // Aplicar estilos de resultado
                const bgColor = isCorrect ? '#d4edda' : '#f8d7da';
                const borderColor = isCorrect ? '#28a745' : '#dc3545';
                const resultClass = isCorrect ? 'correct' : 'incorrect';

                pair.leftElement.classList.remove('paired');
                pair.rightElement.classList.remove('paired');
                pair.leftElement.classList.add(resultClass);
                pair.rightElement.classList.add(resultClass);
                pair.leftElement.style.backgroundColor = bgColor;
                pair.rightElement.style.backgroundColor = bgColor;
                pair.leftElement.style.border = `2px solid ${borderColor}`;
                pair.rightElement.style.border = `2px solid ${borderColor}`;
                pair.leftElement.style.pointerEvents = 'none';
                pair.rightElement.style.pointerEvents = 'none';

                results.push({
                    left: pair.leftText,
                    right: pair.rightText,
                    correct: isCorrect
                });
            });

            // Calcular puntuaci√≥n
            const allCorrect = correctCount === totalPairs;
            const score = Math.round((correctCount / totalPairs) * 100);

            // Mostrar feedback
            const feedbackText = allCorrect
                ? `‚úì ¬°Perfecto! ${correctCount}/${totalPairs} pares correctos. Puntos: ${score}/100`
                : `${correctCount}/${totalPairs} pares correctos. Puntos: ${score}/100. Solo 1 intento.`;

            feedback.className = allCorrect ? 'feedback-message success' : 'feedback-message error';
            feedback.textContent = feedbackText;
            feedback.style.display = 'block';

            // Bloquear ejercicio
            state.isLocked = true;
            const button = exercise.querySelector('.btn-check');
            if (button) {
                button.disabled = true;
                button.style.opacity = '0.5';
                button.style.cursor = 'not-allowed';
            }

            // Bloquear todos los items
            exercise.querySelectorAll('.option-item').forEach(item => {
                item.style.pointerEvents = 'none';
            });

            // Guardar estado
            saveExerciseState(exerciseId, {
                type: 'matching',
                completed: true,
                isCorrect: allCorrect,
                correctCount: correctCount,
                totalPairs: totalPairs,
                feedbackText: feedbackText,
                userMatches: userPairs.map(p => ({
                    left: p.leftText,
                    right: p.rightText,
                    leftMatch: p.leftMatch,
                    rightMatch: p.rightMatch
                }))
            });

            // Send to backend
            sendToBackend({
                type: 'exercise_score',
                module: 'module-1',
                exerciseId: exerciseId,
                exerciseType: 'matching',
                studentEmail: localStorage.getItem('empirica_user_email') || localStorage.getItem('empirica_free_email') || '',
                score: `${correctCount}/${totalPairs}`,
                percentage: score.toString(),
                isCorrect: allCorrect,
                userAnswers: results,
                timestamp: new Date().toISOString()
            });

            console.log(`‚úÖ ${exerciseId} completed. Score: ${score}/100`);
        }

        // Multiple Choice / True-False
        function selectOption(element, groupId) {
            // Prevent selection if element is already marked as correct/incorrect (after check)
            if (element.classList.contains('correct') || element.classList.contains('incorrect')) {
                return;
            }

            // Prevent selection if element is locked
            if (element.classList.contains('locked') || element.style.pointerEvents === 'none') {
                return;
            }

            const container = element.closest('.options-list') || element.parentElement;
            container.querySelectorAll('.option-item').forEach(item => {
                item.classList.remove('selected');
            });
            element.classList.add('selected');
            element.dataset.group = groupId;
        }

        function checkTrueFalse(exerciseId, totalQuestions) {
            const exercise = document.getElementById(exerciseId);
            const feedback = document.getElementById('feedback-' + exerciseId);
            const button = exercise.querySelector('.btn-check');

            let allCorrect = true;
            let answeredAll = true;
            let correctCount = 0;

            // Check answers
            for (let i = 1; i <= totalQuestions; i++) {
                // Find by the onclick pattern - options have onclick="selectOption(this, 'mc4-X')" or onclick="selectOption(this, 'tf5-X')"
                const questionNum = exerciseId === 'exercise4' ? `mc4-${i}` : `tf5-${i}`;
                const selected = exercise.querySelector(`[onclick*="${questionNum}"].selected`);
                if (!selected) {
                    answeredAll = false;
                } else {
                    const isCorrect = selected.dataset.correct === 'true';
                    if (isCorrect) {
                        selected.classList.add('correct');
                        correctCount++;
                    } else {
                        selected.classList.add('incorrect');
                        allCorrect = false;
                    }
                }
            }

            if (!answeredAll) {
                feedback.className = 'feedback-message error';
                feedback.textContent = 'Please answer all questions.';
                return;
            }

            // Initialize attempt tracking
            if (!exerciseAttempts[exerciseId]) {
                exerciseAttempts[exerciseId] = { count: 0, attempts: [] };
            }

            exerciseAttempts[exerciseId].count++;
            const attemptNumber = exerciseAttempts[exerciseId].count;

            // Save attempt data
            const attemptData = {
                attemptNumber: attemptNumber,
                correctCount: correctCount,
                totalQuestions: totalQuestions,
                isCorrect: allCorrect,
                score: (correctCount / totalQuestions) * 100,
                timestamp: new Date().toISOString()
            };
            exerciseAttempts[exerciseId].attempts.push(attemptData);

            // Collect user answers
            const userAnswers = [];
            for (let i = 1; i <= totalQuestions; i++) {
                const selected = exercise.querySelector(`[data-group="tf${exerciseId.slice(-1)}-${i}"].selected`);
                if (selected) {
                    userAnswers.push({
                        question: i,
                        answer: selected.textContent.trim(),
                        correct: selected.dataset.correct === 'true'
                    });
                }
            }

            // Save response
            saveExerciseResponse(
                exerciseId,
                'true-false',
                {
                    attemptNumber: attemptNumber,
                    answers: userAnswers,
                    allAttempts: exerciseAttempts[exerciseId].attempts
                },
                allCorrect,
                (correctCount / totalQuestions) * 100
            );

            let feedbackText = '';
            const score = (correctCount / totalQuestions) * 100;
            const points = Math.round(score);

            // TRUE/FALSE: Solo 1 intento permitido
            if (allCorrect) {
                feedback.className = 'feedback-message success';
                feedbackText = `‚úì All answers are correct! (${correctCount}/${totalQuestions}) - Puntos obtenidos: ${points}/100`;
                feedback.textContent = feedbackText;
                updateExerciseProgress();
            } else {
                feedback.className = 'feedback-message error';
                feedbackText = `${correctCount}/${totalQuestions} correctas. Puntos obtenidos: ${points}/100. Solo se permite 1 intento.`;
                feedback.textContent = feedbackText;
            }

            // Bloquear despu√©s del primer intento (correcto o incorrecto)
            if (button) {
                button.disabled = true;
                button.style.opacity = '0.5';
                button.style.cursor = 'not-allowed';
            }
            exercise.querySelectorAll('.option-item').forEach(item => {
                item.style.pointerEvents = 'none';
            });

            // Save exercise state to localStorage
            saveExerciseState(exerciseId, {
                type: 'true-false',
                userAnswers: userAnswers,
                attempts: exerciseAttempts[exerciseId],
                isCorrect: allCorrect,
                completed: true, // Always completed after first attempt
                feedbackText: feedbackText
            });
        }

        // Levenshtein distance for spell tolerance
        function levenshteinDistance(str1, str2) {
            const len1 = str1.length;
            const len2 = str2.length;
            const matrix = [];

            if (len1 === 0) return len2;
            if (len2 === 0) return len1;

            for (let i = 0; i <= len2; i++) {
                matrix[i] = [i];
            }

            for (let j = 0; j <= len1; j++) {
                matrix[0][j] = j;
            }

            for (let i = 1; i <= len2; i++) {
                for (let j = 1; j <= len1; j++) {
                    if (str2.charAt(i - 1) === str1.charAt(j - 1)) {
                        matrix[i][j] = matrix[i - 1][j - 1];
                    } else {
                        matrix[i][j] = Math.min(
                            matrix[i - 1][j - 1] + 1,
                            matrix[i][j - 1] + 1,
                            matrix[i - 1][j] + 1
                        );
                    }
                }
            }

            return matrix[len2][len1];
        }

        // Check if answer is close enough (tolerates 1-2 character errors)
        function isSpellingClose(userAnswer, correctAnswer) {
            const distance = levenshteinDistance(userAnswer, correctAnswer);
            const maxDistance = correctAnswer.length <= 4 ? 1 : 2;
            return distance <= maxDistance;
        }

        // Fill in the Blanks
        function checkFillBlanks(exerciseId, totalBlanks) {
            // Check if already attempted
            if (exerciseAttempts[exerciseId]) {
                const feedback = document.getElementById('feedback-' + exerciseId);
                feedback.className = 'feedback-message error';
                feedback.textContent = '‚ö† Solo se permite un intento por ejercicio. Ya has usado tu intento.';
                return;
            }

            const exercise = document.getElementById(exerciseId);
            const feedback = document.getElementById('feedback-' + exerciseId);
            const button = exercise.querySelector('.btn-check');

            let allCorrect = true;
            let correctCount = 0;

            for (let i = 1; i <= totalBlanks; i++) {
                const input = document.getElementById(`blank${exerciseId.slice(-1)}-${i}`);
                if (!input) continue;

                const answer = input.dataset.answer.toLowerCase();
                const userAnswer = input.value.trim().toLowerCase();

                // Handle multiple correct answers separated by |
                const correctAnswers = answer.split('|');

                // Check exact match or close spelling
                const isCorrect = correctAnswers.some(ans =>
                    userAnswer === ans || isSpellingClose(userAnswer, ans)
                );

                if (isCorrect) {
                    input.classList.remove('incorrect');
                    input.classList.add('correct');
                    correctCount++;
                } else {
                    input.classList.remove('correct');
                    input.classList.add('incorrect');
                    allCorrect = false;
                }
            }

            // Mark as attempted
            exerciseAttempts[exerciseId] = true;

            // Disable button and all inputs
            if (button) {
                button.disabled = true;
                button.style.opacity = '0.5';
                button.style.cursor = 'not-allowed';
            }

            // Disable further editing
            exercise.querySelectorAll('.fill-blank-input').forEach(input => {
                input.disabled = true;
                input.style.cursor = 'not-allowed';
            });

            const score = (correctCount / totalBlanks) * 100;
            const points = Math.round(score);

            if (allCorrect) {
                feedback.className = 'feedback-message success';
                feedback.textContent = `‚úì All answers are correct! (${correctCount}/${totalBlanks}) - Puntos obtenidos: ${points}/100`;
                updateExerciseProgress();
            } else {
                feedback.className = 'feedback-message error';
                feedback.textContent = `${correctCount}/${totalBlanks} correct. Puntos obtenidos: ${points}/100. (Solo se permite un intento)`;
            }

            // Save response - collect user answers
            const userAnswers = [];
            for (let i = 1; i <= totalBlanks; i++) {
                const input = document.getElementById(`blank${exerciseId.slice(-1)}-${i}`);
                if (input) {
                    const correctAnswers = input.dataset.answer.split('|');
                    const userAnswer = input.value.trim();
                    const isCorrect = correctAnswers.some(ans =>
                        userAnswer.toLowerCase() === ans.toLowerCase() ||
                        isSpellingClose(userAnswer.toLowerCase(), ans.toLowerCase())
                    );
                    userAnswers.push({
                        blank: i,
                        answer: userAnswer,
                        correct: isCorrect,
                        expected: correctAnswers[0]
                    });
                }
            }
            saveExerciseResponse(
                exerciseId,
                'fill-blanks',
                userAnswers,
                allCorrect,
                (correctCount / totalBlanks) * 100
            );
        }

        // Open Questions Exercise (Exercise 4)
        function checkOpenQuestions(exerciseId) {
            const exercise = document.getElementById(exerciseId);
            const feedback = document.getElementById('feedback-' + exerciseId);
            const button = exercise.querySelector('.btn-check');

            // Check if already attempted
            if (exerciseAttempts[exerciseId]) {
                feedback.className = 'feedback-message error';
                feedback.textContent = '‚ö† Solo se permite un intento por ejercicio. Ya has usado tu intento.';
                feedback.style.display = 'block';
                return;
            }

            // Mark as attempted
            exerciseAttempts[exerciseId] = true;

            // Collect all answers
            const answers = [];
            const textareas = exercise.querySelectorAll('textarea');
            let allAnswered = true;

            textareas.forEach((textarea, index) => {
                const answer = textarea.value.trim();
                if (answer === '') {
                    allAnswered = false;
                }
                answers.push({
                    question: index + 1,
                    answer: answer
                });
            });

            if (!allAnswered) {
                feedback.className = 'feedback-message error';
                feedback.textContent = '‚ö† Por favor responde todas las preguntas antes de enviar.';
                feedback.style.display = 'block';
                exerciseAttempts[exerciseId] = false; // Allow retry if incomplete
                return;
            }

            // Disable button and textareas
            if (button) {
                button.disabled = true;
                button.style.opacity = '0.5';
                button.style.cursor = 'not-allowed';
            }

            textareas.forEach(textarea => {
                textarea.disabled = true;
                textarea.style.cursor = 'not-allowed';
            });

            // Show success message
            feedback.className = 'feedback-message success';
            feedback.textContent = '‚úì Respuestas enviadas correctamente. Revisa las respuestas esperadas arriba.';
            feedback.style.display = 'block';

            // Update progress
            updateExerciseProgress();

            // Save response
            saveExerciseResponse(
                exerciseId,
                'open-questions',
                answers,
                true, // Open questions are always marked as attempted
                100 // Give credit for completing
            );
        }

        // Listening Checkbox Exercise
        function toggleCheckbox(element) {
            element.classList.toggle('selected');
            const letter = element.querySelector('.option-letter');
            if (element.classList.contains('selected')) {
                letter.textContent = '‚úì';
            } else {
                letter.textContent = '‚ñ°';
            }
        }

        function checkListening(exerciseId) {
            // Check if already attempted
            if (exerciseAttempts[exerciseId]) {
                const feedback = document.getElementById('feedback-' + exerciseId);
                feedback.className = 'feedback-message error';
                feedback.textContent = '‚ö† Solo se permite un intento por ejercicio. Ya has usado tu intento.';
                return;
            }

            const exercise = document.getElementById(exerciseId);
            const items = exercise.querySelectorAll('.option-item');
            const feedback = document.getElementById('feedback-' + exerciseId);
            const button = exercise.querySelector('.btn-check');

            let allCorrect = true;
            let correctCount = 0;
            let totalCorrect = 0;

            items.forEach(item => {
                const shouldBeSelected = item.dataset.correct === 'true';
                const isSelected = item.classList.contains('selected');

                if (shouldBeSelected) totalCorrect++;

                if (shouldBeSelected === isSelected) {
                    item.classList.remove('incorrect');
                    item.classList.add('correct');
                    if (shouldBeSelected) correctCount++;
                } else {
                    item.classList.remove('correct');
                    item.classList.add('incorrect');
                    allCorrect = false;
                }
            });

            // Mark as attempted
            exerciseAttempts[exerciseId] = true;

            // Disable button and all interactions
            if (button) {
                button.disabled = true;
                button.style.opacity = '0.5';
                button.style.cursor = 'not-allowed';
            }

            // Disable further clicking
            exercise.querySelectorAll('.option-item').forEach(item => {
                item.style.pointerEvents = 'none';
            });

            if (allCorrect) {
                feedback.className = 'feedback-message success';
                feedback.textContent = `‚úì Perfect! You identified all ${totalCorrect} correct items!`;
                updateExerciseProgress();
            } else {
                feedback.className = 'feedback-message error';
                feedback.textContent = `${correctCount}/${totalCorrect} correct items identified. (Solo se permite un intento)`;
            }

            // Save response - collect user selections
            const userAnswers = [];
            items.forEach((item, index) => {
                userAnswers.push({
                    item: index + 1,
                    text: item.textContent.trim(),
                    selected: item.classList.contains('selected'),
                    shouldBeSelected: item.dataset.correct === 'true',
                    correct: (item.classList.contains('selected') === (item.dataset.correct === 'true'))
                });
            });
            saveExerciseResponse(
                exerciseId,
                'listening-checkbox',
                userAnswers,
                allCorrect,
                (correctCount / totalCorrect) * 100
            );
        }

        // Progress tracking
        let completedExercises = 0;
        const totalExercises = 11;

        // Attempt tracking - track number of attempts and results
        let exerciseAttempts = {}; // { exerciseId: { count: 0, attempts: [] } }

        function updateExerciseProgress() {
            completedExercises++;
            const progress = (completedExercises / totalExercises) * 100;
            document.getElementById('progressFill').style.width = progress + '%';
            localStorage.setItem('module1_progress', completedExercises);
        }

        function loadProgress() {
            const saved = localStorage.getItem('module1_progress');
            if (saved) {
                completedExercises = parseInt(saved);
                const progress = (completedExercises / totalExercises) * 100;
                document.getElementById('progressFill').style.width = progress + '%';
            }
        }

        // Mobile menu toggle
        function toggleMenu() {
            document.getElementById('navMenu').classList.toggle('active');
        }

        // ============================================
        // RESPONSE TRACKING SYSTEM
        // ============================================

        // ‚öôÔ∏è BACKEND CONFIGURATION
        // TODO: Replace with your Google Apps Script Web App URL
        // Get it from: Apps Script > Deploy > Manage deployments > Web app URL
        // Format: https://script.google.com/macros/s/AKfycbxXXXXXXXXXXXXXX/exec
        // Guide: cursos/legal-english/google-apps-script/GUIA-CONFIGURACION.md
        const BACKEND_URL = 'https://script.google.com/macros/s/AKfycbwLjiDy5ZEpP97JUF-FA8Z4Lf6mbMHDDUzLH0JH9rGXFCHnh9KLeSU8oBNS3NTDFb4Xvg/exec';

        // Student Information Functions
        function saveStudentInfo() {
            console.log('üü¶ saveStudentInfo() called');

            const nameInput = document.getElementById('studentName');
            const emailInput = document.getElementById('studentEmail');
            const feedback = document.getElementById('student-info-feedback');

            console.log('üü¶ Name input element:', nameInput);
            console.log('üü¶ Email input element:', emailInput);

            const name = nameInput.value.trim();
            const email = emailInput.value.trim();

            console.log('üü¶ Name value:', name);
            console.log('üü¶ Email value:', email);

            if (!name) {
                feedback.style.display = 'block';
                feedback.style.background = 'rgba(220, 53, 69, 0.1)';
                feedback.style.border = '1px solid #dc3545';
                feedback.style.color = '#721c24';
                feedback.textContent = '‚ö†Ô∏è Please enter your name / Por favor ingresa tu nombre';
                console.log('‚ùå Name is empty, aborting save');
                return;
            }

            // Save to localStorage
            console.log('üü¶ Saving to localStorage...');
            localStorage.setItem('student_name', name);
            console.log('üü¶ Saved student_name:', localStorage.getItem('student_name'));

            if (email) {
                localStorage.setItem('student_email', email);
                localStorage.setItem('empirica_user_email', email); // For compatibility
                console.log('üü¶ Saved student_email:', localStorage.getItem('student_email'));
            }

            // VERIFY IT WAS SAVED
            const verifyName = localStorage.getItem('student_name');
            const verifyEmail = localStorage.getItem('student_email');
            console.log('‚úÖ VERIFICATION - Name in localStorage:', verifyName);
            console.log('‚úÖ VERIFICATION - Email in localStorage:', verifyEmail);

            // Show success message
            feedback.style.display = 'block';
            feedback.style.background = 'rgba(40, 167, 69, 0.1)';
            feedback.style.border = '1px solid #28a745';
            feedback.style.color = '#155724';
            feedback.textContent = '‚úì Saved! Name: ' + verifyName + ' | Email: ' + verifyEmail;

            // Disable inputs
            nameInput.disabled = true;
            emailInput.disabled = true;
            document.querySelector('button[onclick="saveStudentInfo()"]').disabled = true;
            document.querySelector('button[onclick="saveStudentInfo()"]').style.opacity = '0.5';

            console.log('‚úÖ Student info saved and verified!');

            // Alert to make it super obvious
            alert('‚úÖ GUARDADO!\n\nNombre: ' + verifyName + '\nEmail: ' + verifyEmail + '\n\nAhora puedes hacer los ejercicios.');
        }

        function loadStudentInfo() {
            const name = localStorage.getItem('student_name');
            const email = localStorage.getItem('student_email') || localStorage.getItem('empirica_user_email');

            if (name) {
                const nameInput = document.getElementById('studentName');
                const emailInput = document.getElementById('studentEmail');
                const feedback = document.getElementById('student-info-feedback');
                const button = document.querySelector('button[onclick="saveStudentInfo()"]');

                if (nameInput) nameInput.value = name;
                if (emailInput && email) emailInput.value = email;

                // Show that info is already saved
                if (feedback) {
                    feedback.style.display = 'block';
                    feedback.style.background = 'rgba(40, 167, 69, 0.1)';
                    feedback.style.border = '1px solid #28a745';
                    feedback.style.color = '#155724';
                    feedback.textContent = '‚úì Welcome back, ' + name + '! / ¬°Bienvenido de nuevo, ' + name + '!';
                }

                // Disable inputs since already saved
                if (nameInput) nameInput.disabled = true;
                if (emailInput) emailInput.disabled = true;
                if (button) {
                    button.disabled = true;
                    button.style.opacity = '0.5';
                }

                console.log('‚úÖ Student info loaded from localStorage:', { name, email });
            }
        }

        function getStudentInfo() {
            console.log('üîç getStudentInfo() called');
            console.log('üîç ALL localStorage keys:', Object.keys(localStorage));

            const name = localStorage.getItem('student_name');
            const email = localStorage.getItem('student_email') || localStorage.getItem('empirica_user_email');

            console.log('üîç student_name from localStorage:', name);
            console.log('üîç student_email from localStorage:', email);

            const result = {
                name: name || 'Anonymous',
                email: email || 'not provided'
            };

            console.log('üìã Returning student info:', result);

            // CRITICAL WARNING if name is missing
            if (!name) {
                console.error('‚ùå‚ùå‚ùå WARNING: No student_name in localStorage! Will send as "Anonymous"');
                console.error('‚ùå Please fill out the Student Information form at the top of the page!');
            }

            return result;
        }

        // Save exercise response
        function saveExerciseResponse(exerciseId, exerciseType, userAnswers, isCorrect, score) {
            const studentInfo = getStudentInfo();
            const timestamp = new Date().toISOString();

            const response = {
                module: 'module-1',
                exerciseId: exerciseId,
                exerciseType: exerciseType,
                studentName: studentInfo.name,
                studentEmail: studentInfo.email,
                timestamp: timestamp,
                userAnswers: userAnswers,
                isCorrect: isCorrect,
                score: score
            };

            console.log('üíæ Saving exercise response:', response);

            // Get existing responses
            let responses = JSON.parse(localStorage.getItem('module1_responses') || '[]');
            responses.push(response);
            localStorage.setItem('module1_responses', JSON.stringify(responses));

            // Also send to backend if configured
            sendToBackend(response);
        }

        // ============================================
        // EXERCISE STATE PERSISTENCE
        // ============================================

        function saveExerciseState(exerciseId, state) {
            const key = 'exercise_state_' + exerciseId;
            localStorage.setItem(key, JSON.stringify(state));
            console.log('üíæ Saved exercise state for ' + exerciseId, state);
        }

        function loadExerciseState(exerciseId) {
            const key = 'exercise_state_' + exerciseId;
            const saved = localStorage.getItem(key);
            if (saved) {
                console.log('üìÇ Loaded exercise state for ' + exerciseId);
                return JSON.parse(saved);
            }
            return null;
        }

        // Utility function to clear exercise states (available in browser console)
        window.clearExerciseStates = function(exerciseId) {
            if (exerciseId) {
                // Clear specific exercise
                const key = 'exercise_state_' + exerciseId;
                localStorage.removeItem(key);
                console.log(`‚úÖ Cleared state for ${exerciseId}. Reload the page to see changes.`);
            } else {
                // Clear all exercise states
                const keys = Object.keys(localStorage).filter(key => key.startsWith('exercise_state_'));
                keys.forEach(key => localStorage.removeItem(key));
                console.log(`‚úÖ Cleared ${keys.length} exercise states. Reload the page to see changes.`);
            }
        };

        // Utility to reset ALL matching exercises
        window.resetMatchingExercises = function() {
            ['exercise1', 'exercise8', 'exercise11'].forEach(id => {
                localStorage.removeItem('exercise_state_' + id);

                // Clear state
                if (matchingExercises[id]) {
                    delete matchingExercises[id];
                }

                // Clear visual state
                const exercise = document.getElementById(id);
                if (exercise) {
                    exercise.querySelectorAll('.option-item').forEach(item => {
                        delete item.dataset.paired;
                        item.classList.remove('paired', 'selected', 'correct', 'incorrect');
                        item.style.backgroundColor = '';
                        item.style.border = '';
                        item.style.pointerEvents = '';
                        item.style.cursor = '';
                        item.title = '';
                    });
                    const button = exercise.querySelector('.btn-check');
                    if (button) {
                        button.disabled = false;
                        button.style.opacity = '';
                        button.style.cursor = '';
                    }
                    const feedback = document.getElementById('feedback-' + id);
                    if (feedback) {
                        feedback.textContent = '';
                        feedback.style.display = 'none';
                        feedback.className = '';
                    }
                }
            });
            console.log('‚úÖ Reset all matching exercises (1, 8, 11). You can now try them again!');
        };

        function restoreAllExercises() {
            console.log('üîÑ Restoring all exercise states from localStorage...');

            // Get all exercise state keys
            const exerciseKeys = Object.keys(localStorage).filter(key => key.startsWith('exercise_state_'));

            exerciseKeys.forEach(key => {
                const exerciseId = key.replace('exercise_state_', '');
                const state = JSON.parse(localStorage.getItem(key));

                console.log('üîÑ Restoring ' + exerciseId, state);

                const exercise = document.getElementById(exerciseId);
                if (!exercise) return;

                const feedback = document.getElementById('feedback-' + exerciseId);
                const button = exercise.querySelector('.btn-check');

                // Restore based on exercise type
                if (state.type === 'matching') {
                    restoreMatchingExercise(exerciseId, state, exercise, feedback, button);
                } else if (state.type === 'true-false') {
                    restoreTrueFalseExercise(exerciseId, state, exercise, feedback, button);
                } else if (state.type === 'fill-blanks') {
                    restoreFillBlanksExercise(exerciseId, state, exercise, feedback, button);
                } else if (state.type === 'listening') {
                    restoreListeningExercise(exerciseId, state, exercise, feedback, button);
                }
            });
        }

        function restoreMatchingExercise(exerciseId, state, exercise, feedback, button) {
            console.log(`üîÑ Restoring matching exercise ${exerciseId}`, state);

            // Only restore if completed
            if (!state.completed) {
                console.log(`‚ö†Ô∏è Exercise ${exerciseId} not completed, skipping restore`);
                return;
            }

            // Restore user matches
            if (state.userMatches) {
                // Initialize the exercise state
                initMatchingExercise(exerciseId);
                const exState = matchingExercises[exerciseId];

                // Find elements and restore their visual state
                state.userMatches.forEach((match, index) => {
                    // Find elements by their data-match attribute and text content
                    const allItems = exercise.querySelectorAll('[data-match]');
                    let leftElem = null;
                    let rightElem = null;

                    allItems.forEach(item => {
                        const itemText = item.textContent.trim();
                        // More flexible matching - check if the text contains the match text
                        if (item.dataset.match === match.leftMatch && (itemText === match.left || itemText.includes(match.left))) {
                            leftElem = item;
                        }
                        if (item.dataset.match === match.rightMatch && (itemText === match.right || itemText.includes(match.right))) {
                            rightElem = item;
                        }
                    });

                    if (leftElem && rightElem) {
                        const pairId = `${exerciseId}-pair-${index + 1}`;
                        const isCorrect = match.leftMatch === match.rightMatch;

                        // Mark as paired
                        leftElem.dataset.paired = pairId;
                        rightElem.dataset.paired = pairId;

                        // Visual state
                        if (isCorrect) {
                            leftElem.classList.add('correct');
                            rightElem.classList.add('correct');
                            leftElem.style.backgroundColor = '#d4edda';
                            rightElem.style.backgroundColor = '#d4edda';
                            leftElem.style.border = '2px solid #28a745';
                            rightElem.style.border = '2px solid #28a745';
                        } else {
                            leftElem.classList.add('incorrect');
                            rightElem.classList.add('incorrect');
                            leftElem.style.backgroundColor = '#f8d7da';
                            rightElem.style.backgroundColor = '#f8d7da';
                            leftElem.style.border = '2px solid #dc3545';
                            rightElem.style.border = '2px solid #dc3545';
                        }

                        // Disable elements
                        leftElem.style.pointerEvents = 'none';
                        rightElem.style.pointerEvents = 'none';

                        // Store in state
                        exState.pairs.push({
                            pairId: pairId,
                            leftElement: leftElem,
                            rightElement: rightElem,
                            leftMatch: match.leftMatch,
                            rightMatch: match.rightMatch,
                            leftText: match.left,
                            rightText: match.right
                        });
                    }
                });

                exState.pairCounter = state.userMatches.length;
            }

            // Restore attempt tracking
            if (state.attempts) {
                exerciseAttempts[exerciseId] = state.attempts;
            }

            // Restore feedback and button state
            if (feedback) {
                feedback.className = state.isCorrect ? 'feedback-message success' : 'feedback-message error';
                feedback.textContent = state.feedbackText || '';
                feedback.style.display = 'block';
            }

            if (button) {
                button.disabled = true;
                button.style.opacity = '0.5';
                button.style.cursor = 'not-allowed';
            }

            // Disable all items
            exercise.querySelectorAll('.option-item').forEach(item => {
                item.style.pointerEvents = 'none';
            });
        }

        function restoreTrueFalseExercise(exerciseId, state, exercise, feedback, button) {
            // Restore selections
            if (state.userAnswers) {
                state.userAnswers.forEach(answer => {
                    // Use onclick attribute to find options (e.g., tf3-1, mc4-1)
                    const exerciseNum = exerciseId.slice(-1);
                    let prefix = 'tf';
                    // exercise4 and exercise5 use 'mc' prefix, exercise3 uses 'tf'
                    if (exerciseId === 'exercise4' || exerciseId === 'exercise5') {
                        prefix = 'mc';
                    }
                    const selector = `[onclick*="${prefix}${exerciseNum}-${answer.question}"]`;
                    const options = exercise.querySelectorAll(selector);

                    options.forEach(option => {
                        if (option.textContent.trim() === answer.answer) {
                            option.classList.add('selected');
                            if (answer.correct) {
                                option.classList.add('correct');
                            } else {
                                option.classList.add('incorrect');
                            }
                        }
                    });
                });
            }

            // Restore attempt tracking
            if (state.attempts) {
                exerciseAttempts[exerciseId] = state.attempts;
            }

            // Restore feedback and disable if completed
            if (state.completed) {
                if (feedback) {
                    feedback.className = state.isCorrect ? 'feedback-message success' : 'feedback-message error';
                    feedback.textContent = state.feedbackText || '';
                    feedback.style.display = 'block';
                }

                if (button) {
                    button.disabled = true;
                    button.style.opacity = '0.5';
                    button.style.cursor = 'not-allowed';
                }

                exercise.querySelectorAll('.option-item').forEach(item => {
                    item.style.pointerEvents = 'none';
                });
            }
        }

        function restoreFillBlanksExercise(exerciseId, state, exercise, feedback, button) {
            // Restore input values
            if (state.userAnswers) {
                state.userAnswers.forEach(answer => {
                    const input = exercise.querySelector(`input[data-answer="${answer.correctAnswer}"]`);
                    if (input) {
                        input.value = answer.userAnswer;
                        if (state.completed) {
                            input.disabled = true;
                            if (answer.correct) {
                                input.style.borderColor = '#28a745';
                                input.style.backgroundColor = '#d4edda';
                            } else {
                                input.style.borderColor = '#dc3545';
                                input.style.backgroundColor = '#f8d7da';
                            }
                        }
                    }
                });
            }

            // Restore feedback and disable if completed
            if (state.completed) {
                if (feedback) {
                    feedback.className = state.isCorrect ? 'feedback-message success' : 'feedback-message error';
                    feedback.textContent = state.feedbackText || '';
                    feedback.style.display = 'block';
                }

                if (button) {
                    button.disabled = true;
                    button.style.opacity = '0.5';
                    button.style.cursor = 'not-allowed';
                }
            }
        }

        function restoreListeningExercise(exerciseId, state, exercise, feedback, button) {
            // Restore checkbox selections
            if (state.userAnswers) {
                state.userAnswers.forEach(answer => {
                    const checkbox = exercise.querySelector(`input[value="${answer.option}"]`);
                    if (checkbox) {
                        checkbox.checked = answer.checked;
                        if (state.completed) {
                            checkbox.disabled = true;
                        }
                    }
                });
            }

            // Restore feedback and disable if completed
            if (state.completed) {
                if (feedback) {
                    feedback.className = state.isCorrect ? 'feedback-message success' : 'feedback-message error';
                    feedback.textContent = state.feedbackText || '';
                    feedback.style.display = 'block';
                }

                if (button) {
                    button.disabled = true;
                    button.style.opacity = '0.5';
                    button.style.cursor = 'not-allowed';
                }
            }
        }

        // Send data to backend (Google Sheets or custom endpoint)
        function sendToBackend(data) {
            // Check if backend is configured
            if (BACKEND_URL.includes('YOUR_SCRIPT_ID')) {
                console.warn('‚ö†Ô∏è BACKEND NOT CONFIGURED');
                console.warn('üìù Data saved locally only (localStorage)');
                console.warn('üìö To configure backend, see: cursos/legal-english/google-apps-script/GUIA-CONFIGURACION.md');
                console.log('üíæ Data that would be sent:', data);
                return;
            }

            console.log('üì§ Attempting to send data to backend...');
            console.log('üîó Backend URL:', BACKEND_URL);
            console.log('üì¶ Data:', JSON.stringify(data, null, 2));

            // Usar no-cors con text/plain para evitar preflight CORS
            fetch(BACKEND_URL, {
                method: 'POST',
                mode: 'no-cors',
                headers: {
                    'Content-Type': 'text/plain'
                },
                body: JSON.stringify(data)
            })
            .then(() => {
                console.log('‚úÖ Data sent successfully (no-cors mode)');
                console.log('‚ÑπÔ∏è Check your Google Sheet to verify data was received');
            })
            .catch(error => {
                console.error('‚ùå Error sending data:', error);
                console.log('üíæ Data is still saved locally in localStorage');
            });
        }

        // Export responses to JSON file
        function exportResponses() {
            const responses = localStorage.getItem('module1_responses') || '[]';
            const blob = new Blob([responses], { type: 'application/json' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `module1_responses_${new Date().toISOString()}.json`;
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            URL.revokeObjectURL(url);
        }

        // Survey form handler
        document.addEventListener('DOMContentLoaded', function() {
            console.log('üöÄ Page loaded - initializing...');

            // Load student information
            loadStudentInfo();

            // Restore all exercise states
            restoreAllExercises();

            // Load progress
            loadProgress();

            const surveyForm = document.getElementById('surveyForm');
            if (surveyForm) {
                surveyForm.addEventListener('submit', function(e) {
                    e.preventDefault();

                    const formData = new FormData(surveyForm);
                    const studentInfo = getStudentInfo();
                    const surveyData = {
                        module: 'module-1',
                        studentName: studentInfo.name,
                        studentEmail: studentInfo.email,
                        timestamp: new Date().toISOString(),
                        difficulty: formData.get('difficulty'),
                        quality: formData.get('quality'),
                        most_useful: formData.get('most_useful'),
                        suggestions: formData.get('suggestions'),
                        time_spent: formData.get('time_spent')
                    };

                    // Save survey to localStorage
                    let surveys = JSON.parse(localStorage.getItem('module_surveys') || '[]');
                    surveys.push(surveyData);
                    localStorage.setItem('module_surveys', JSON.stringify(surveys));

                    // Send to backend
                    sendToBackend({ type: 'survey', data: surveyData });

                    // Show success message
                    const feedback = document.getElementById('feedback-survey');
                    feedback.className = 'feedback-message success';
                    feedback.textContent = '‚úì Thank you for your feedback! / ¬°Gracias por tu retroalimentaci√≥n!';

                    // Disable form
                    surveyForm.querySelectorAll('input, textarea, select, button').forEach(el => {
                        el.disabled = true;
                    });
                    surveyForm.style.opacity = '0.6';
                });
            }

            // Load YouTube IFrame API
            const tag = document.createElement('script');
            tag.src = "https://www.youtube.com/iframe_api";
            const firstScriptTag = document.getElementsByTagName('script')[0];
            firstScriptTag.parentNode.insertBefore(tag, firstScriptTag);
        });

        // ========== GLOBAL VALIDATION FUNCTIONS FOR MODULE 1 ==========
        // These functions MUST be in global scope to be accessible from onclick handlers

        /**
         * Validates Exercise 3 (True/False - tf3-1 to tf3-6)
         */
        function checkExercise3() {
            console.log('üîç checkExercise3 called');
            const exercise = document.getElementById('exercise3');
            if (!exercise) {
                console.error('Exercise 3 not found');
                return;
            }

            const feedback = document.getElementById('feedback-exercise3');
            if (!feedback) {
                console.error('Feedback element for exercise 3 not found');
                return;
            }

            // Check if already completed
            const savedState = loadExerciseState('exercise3');
            if (savedState && savedState.completed) {
                feedback.textContent = '‚úì Exercise already completed and locked.';
                feedback.className = 'feedback-message success';
                feedback.style.display = 'block';
                return;
            }

            const questionIds = ['tf3-1', 'tf3-2', 'tf3-3', 'tf3-4', 'tf3-5', 'tf3-6'];
            let allAnswered = true;
            let correctCount = 0;
            const results = [];

            questionIds.forEach(qId => {
                const selected = exercise.querySelector(`[onclick*="${qId}"].selected`);
                if (!selected) {
                    allAnswered = false;
                    return;
                }

                const isCorrect = selected.getAttribute('data-correct') === 'true';
                if (isCorrect) {
                    selected.classList.add('correct');
                    correctCount++;
                } else {
                    selected.classList.add('incorrect');
                }

                results.push({
                    questionId: qId,
                    answer: selected.textContent.trim(),
                    correct: isCorrect
                });
            });

            if (!allAnswered) {
                feedback.textContent = '‚úó Please answer all 6 questions before checking.';
                feedback.className = 'feedback-message error';
                feedback.style.display = 'block';
                return;
            }

            const totalQuestions = questionIds.length;
            const score = (correctCount / totalQuestions) * 100;
            const points = Math.round(score);
            const allCorrect = correctCount === totalQuestions;

            // Show feedback with points
            const feedbackText = `Score: ${correctCount}/${totalQuestions} correct. Puntos obtenidos: ${points}/100`;
            feedback.textContent = feedbackText;
            feedback.className = allCorrect ? 'feedback-message success' : 'feedback-message error';
            feedback.style.display = 'block';

            // Convert results to userAnswers format for restoration compatibility
            const userAnswers = results.map((r, i) => ({
                question: i + 1,
                answer: r.answer,
                correct: r.correct
            }));

            // Save state
            saveExerciseState('exercise3', {
                type: 'true-false',
                completed: true,
                score: `${correctCount}/${totalQuestions}`,
                points: points,
                isCorrect: allCorrect,
                userAnswers: userAnswers,
                feedbackText: feedbackText
            });

            // Send to backend
            sendToBackend({
                type: 'exercise_score',
                module: 'module-1',
                exerciseId: 'exercise3',
                exerciseType: 'true-false',
                studentEmail: localStorage.getItem('empirica_user_email') || localStorage.getItem('empirica_free_email') || '',
                score: `${correctCount}/${totalQuestions}`,
                percentage: score.toFixed(1),
                isCorrect: allCorrect,
                userAnswers: userAnswers,
                timestamp: new Date().toISOString()
            });

            // Lock exercise
            const button = exercise.querySelector('.btn-check');
            if (button) {
                button.disabled = true;
                button.style.opacity = '0.5';
                button.style.cursor = 'not-allowed';
            }
            exercise.querySelectorAll('.option-item').forEach(item => {
                item.style.pointerEvents = 'none';
            });

            console.log(`‚úÖ Exercise 3 checked. Score: ${points}/100`);
        }

        /**
         * Validates Exercise 4 (Multiple Choice - mc4-1, mc4-2, mc4-3, mc4-4)
         */
        function checkExercise4() {
            console.log('üîç checkExercise4 called');
            const exercise = document.getElementById('exercise4');
            if (!exercise) {
                console.error('Exercise 4 not found');
                return;
            }

            const feedback = document.getElementById('feedback-exercise4');
            if (!feedback) {
                console.error('Feedback element for exercise 4 not found');
                return;
            }

            // Check if already completed
            const savedState = loadExerciseState('exercise4');
            if (savedState && savedState.completed) {
                feedback.textContent = '‚úì Exercise already completed and locked.';
                feedback.className = 'feedback-message success';
                feedback.style.display = 'block';
                return;
            }

            const questionIds = ['mc4-1', 'mc4-2', 'mc4-3', 'mc4-4'];
            let allAnswered = true;
            let correctCount = 0;
            const results = [];

            questionIds.forEach(qId => {
                const selected = exercise.querySelector(`[onclick*="${qId}"].selected`);
                if (!selected) {
                    allAnswered = false;
                    return;
                }

                const isCorrect = selected.getAttribute('data-correct') === 'true';
                if (isCorrect) {
                    selected.classList.add('correct');
                    correctCount++;
                } else {
                    selected.classList.add('incorrect');
                }

                results.push({
                    questionId: qId,
                    answer: selected.textContent.trim(),
                    correct: isCorrect
                });
            });

            if (!allAnswered) {
                feedback.textContent = '‚úó Please answer all 4 questions before checking.';
                feedback.className = 'feedback-message error';
                feedback.style.display = 'block';
                return;
            }

            const totalQuestions = questionIds.length;
            const score = (correctCount / totalQuestions) * 100;
            const points = Math.round(score);
            const allCorrect = correctCount === totalQuestions;

            // Show feedback with points
            const feedbackText = `Score: ${correctCount}/${totalQuestions} correct. Puntos obtenidos: ${points}/100`;
            feedback.textContent = feedbackText;
            feedback.className = allCorrect ? 'feedback-message success' : 'feedback-message error';
            feedback.style.display = 'block';

            // Save state
            saveExerciseState('exercise4', {
                type: 'multiple-choice',
                completed: true,
                score: `${correctCount}/${totalQuestions}`,
                points: points,
                isCorrect: allCorrect,
                feedbackText: feedbackText
            });

            // Send to backend
            sendToBackend({
                type: 'exercise_score',
                module: 'module-1',
                exerciseId: 'exercise4',
                exerciseType: 'multiple-choice',
                studentEmail: localStorage.getItem('empirica_user_email') || localStorage.getItem('empirica_free_email') || '',
                score: `${correctCount}/${totalQuestions}`,
                percentage: score.toFixed(1),
                isCorrect: allCorrect,
                userAnswers: results,
                timestamp: new Date().toISOString()
            });

            // Lock exercise
            const button = exercise.querySelector('.btn-check');
            if (button) {
                button.disabled = true;
                button.style.opacity = '0.5';
                button.style.cursor = 'not-allowed';
            }
            exercise.querySelectorAll('.option-item').forEach(item => {
                item.style.pointerEvents = 'none';
            });

            console.log(`‚úÖ Exercise 4 checked. Score: ${points}/100`);
        }

        /**
         * Validates Exercise 5 (Multiple Choice - mc5-1, mc5-2, mc5-3, mc5-4, mc5-5)
         */
        function checkExercise5() {
            console.log('üîç checkExercise5 called');
            const exercise = document.getElementById('exercise5');
            if (!exercise) {
                console.error('Exercise 5 not found');
                return;
            }

            const feedback = document.getElementById('feedback-exercise5');
            if (!feedback) {
                console.error('Feedback element for exercise 5 not found');
                return;
            }

            // Check if already completed
            const savedState = loadExerciseState('exercise5');
            if (savedState && savedState.completed) {
                feedback.textContent = '‚úì Exercise already completed and locked.';
                feedback.className = 'feedback-message success';
                feedback.style.display = 'block';
                return;
            }

            const questionIds = ['mc5-1', 'mc5-2', 'mc5-3', 'mc5-4', 'mc5-5'];
            let allAnswered = true;
            let correctCount = 0;
            const results = [];

            questionIds.forEach(qId => {
                const selected = exercise.querySelector(`[onclick*="${qId}"].selected`);
                if (!selected) {
                    allAnswered = false;
                    return;
                }

                const isCorrect = selected.getAttribute('data-correct') === 'true';
                if (isCorrect) {
                    selected.classList.add('correct');
                    correctCount++;
                } else {
                    selected.classList.add('incorrect');
                }

                results.push({
                    questionId: qId,
                    answer: selected.textContent.trim(),
                    correct: isCorrect
                });
            });

            if (!allAnswered) {
                feedback.textContent = '‚úó Please answer all 5 questions before checking.';
                feedback.className = 'feedback-message error';
                feedback.style.display = 'block';
                return;
            }

            const totalQuestions = questionIds.length;
            const score = (correctCount / totalQuestions) * 100;
            const points = Math.round(score);
            const allCorrect = correctCount === totalQuestions;

            // Show feedback with points
            const feedbackText = `Score: ${correctCount}/${totalQuestions} correct. Puntos obtenidos: ${points}/100`;
            feedback.textContent = feedbackText;
            feedback.className = allCorrect ? 'feedback-message success' : 'feedback-message error';
            feedback.style.display = 'block';

            // Save state
            saveExerciseState('exercise5', {
                type: 'multiple-choice',
                completed: true,
                score: `${correctCount}/${totalQuestions}`,
                points: points,
                isCorrect: allCorrect,
                feedbackText: feedbackText
            });

            // Send to backend
            sendToBackend({
                type: 'exercise_score',
                module: 'module-1',
                exerciseId: 'exercise5',
                exerciseType: 'multiple-choice',
                studentEmail: localStorage.getItem('empirica_user_email') || localStorage.getItem('empirica_free_email') || '',
                score: `${correctCount}/${totalQuestions}`,
                percentage: score.toFixed(1),
                isCorrect: allCorrect,
                userAnswers: results,
                timestamp: new Date().toISOString()
            });

            // Lock exercise
            const button = exercise.querySelector('.btn-check');
            if (button) {
                button.disabled = true;
                button.style.opacity = '0.5';
                button.style.cursor = 'not-allowed';
            }
            exercise.querySelectorAll('.option-item').forEach(item => {
                item.style.pointerEvents = 'none';
            });

            console.log(`‚úÖ Exercise 5 checked. Score: ${points}/100`);
        }

        // YouTube API Ready Callback
        function onYouTubeIframeAPIReady() {
            player = new YT.Player('videoPlayer', {
                height: '100%',
                width: '100%',
                videoId: '8OVCGYM1HNM',
                playerVars: {
                    'enablejsapi': 1,
                    'origin': window.location.origin
                },
                events: {
                    'onReady': onPlayerReady,
                    'onStateChange': onPlayerStateChange
                }
            });
        }

        function onPlayerReady(event) {
            console.log('YouTube player is ready');
            // Update progress every second
            setInterval(updateProgress, 1000);
        }

        function onPlayerStateChange(event) {
            // Optional: handle state changes
            if (event.data == YT.PlayerState.PLAYING) {
                console.log('Video is playing');
            }
        }
    </script>

    <!--
    NOTA: module-functions.js DESHABILITADO para m√≥dulo 1
    Este m√≥dulo tiene sus propias implementaciones en el script inline.
    Cargar module-functions.js causaba conflictos porque sobrescrib√≠a
    las funciones selectMatch, selectOption, checkExercise3/4/5, etc.
    -->
    <!-- <script src="../../shared/module-functions.js"></script> -->

    <!-- Payment & Access Control System -->
    <script src="../../../../js/payment-access-control.js"></script>
</body>
</html>
