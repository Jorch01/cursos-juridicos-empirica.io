<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Verificar Diploma | Emp√≠rica Legal Lab</title>
    <link rel="stylesheet" href="css/styles.css">
    <style>
        .verify-container {
            max-width: 800px;
            margin: 60px auto;
            padding: 0 20px;
        }
        
        .verify-card {
            background: white;
            padding: 40px;
            border-radius: 15px;
            box-shadow: 0 4px 20px rgba(27, 44, 39, 0.1);
            text-align: center;
        }
        
        .diploma-info {
            background: #F5F5F5;
            padding: 30px;
            border-radius: 12px;
            margin: 30px 0;
            text-align: left;
        }
        
        .info-row {
            display: flex;
            justify-content: space-between;
            padding: 12px 0;
            border-bottom: 1px solid #E1E8E5;
        }
        
        .info-row:last-child {
            border-bottom: none;
        }
        
        .info-label {
            color: #6C757D;
            font-weight: 600;
        }
        
        .info-value {
            color: #1B2C27;
            font-weight: 700;
        }
        
        .verify-status {
            padding: 20px;
            border-radius: 12px;
            margin: 30px 0;
            font-size: 1.1rem;
            font-weight: 600;
        }
        
        .status-valid {
            background: #D4EDDA;
            color: #155724;
            border: 2px solid #28A745;
        }
        
        .status-invalid {
            background: #F8D7DA;
            color: #721C24;
            border: 2px solid #DC3545;
        }
        
        .status-loading {
            background: #FFF3CD;
            color: #856404;
            border: 2px solid #FFC107;
        }
        
        .search-box {
            display: flex;
            gap: 15px;
            margin: 30px 0;
            flex-wrap: wrap;
        }
        
        .search-input {
            flex: 1;
            min-width: 250px;
            padding: 12px 20px;
            border: 2px solid #E1E8E5;
            border-radius: 12px;
            font-size: 1rem;
        }
        
        .search-input:focus {
            outline: none;
            border-color: #CFA892;
        }
        
        @media (max-width: 600px) {
            .search-box {
                flex-direction: column;
            }
            
            .search-input {
                width: 100%;
            }
            
            .btn {
                width: 100%;
            }
        }
    </style>
</head>
<body>
    <!-- HEADER -->
    <header class="header">
        <nav class="nav-container">
            <div class="logo-container">
                <img src="https://i.postimg.cc/tCVcj2Sw/Captura-de-pantalla-2025-10-04-a-la-s-2-33-47-p-m.png" alt="Emp√≠rica Legal Lab" class="logo-img">
                <div class="logo-text">
                    <h1>Emp√≠rica Legal Lab</h1>
                    <p>Formaci√≥n jur√≠dica accesible</p>
                </div>
            </div>
            <button class="mobile-menu-toggle" onclick="toggleMenu()">‚ò∞</button>
            <ul class="nav-menu" id="navMenu">
                <li><a href="index.html">Inicio</a></li>
                <li><a href="index.html#cursos">Cursos</a></li>
                <li><a href="diplomas.html">Diplomas</a></li>
                <li><a href="contacto.html">Contacto</a></li>
            </ul>
        </nav>
    </header>

    <!-- CONTENIDO PRINCIPAL -->
    <div class="verify-container">
        <div class="verify-card">
            <div style="font-size: 4rem; margin-bottom: 20px;">üîç</div>
            <h1 style="color: #1B2C27; font-size: 2.5rem; margin-bottom: 20px;">
                Verificar Diploma
            </h1>
            <p style="color: #6C757D; font-size: 1.1rem; margin-bottom: 30px;">
                Verifica la autenticidad de un diploma emitido por Emp√≠rica Legal Lab
            </p>

            <!-- B√öSQUEDA MANUAL -->
            <div class="search-box">
                <input 
                    type="text" 
                    id="searchInput" 
                    class="search-input" 
                    placeholder="Ingresa el ID del diploma (ej: EMPJUR-2025-001)"
                    onkeypress="if(event.key==='Enter') verifyDiploma()"
                >
                <button class="btn btn-primary" onclick="verifyDiploma()">
                    Verificar Diploma
                </button>
            </div>

            <!-- RESULTADO DE VERIFICACI√ìN -->
            <div id="verificationResult"></div>
        </div>

        <!-- INFORMACI√ìN ADICIONAL -->
        <div style="background: white; padding: 30px; border-radius: 15px; box-shadow: 0 4px 20px rgba(27, 44, 39, 0.1); margin-top: 40px;">
            <h3 style="color: #1B2C27; margin-bottom: 20px; text-align: center;">
                ‚ÑπÔ∏è Sobre la Verificaci√≥n de Diplomas
            </h3>
            <div style="color: #6C757D; line-height: 1.8;">
                <p style="margin-bottom: 15px;">
                    <strong style="color: #1B2C27;">¬øC√≥mo funciona?</strong><br>
                    Cada diploma emitido por Emp√≠rica Legal Lab contiene un c√≥digo QR √∫nico que permite verificar su autenticidad en l√≠nea. Solo los diplomas aut√©nticos aparecer√°n en nuestra base de datos oficial.
                </p>
                <p style="margin-bottom: 15px;">
                    <strong style="color: #1B2C27;">¬øQu√© informaci√≥n se muestra?</strong><br>
                    Al verificar un diploma v√°lido, se mostrar√°: nombre del titular, curso completado, fecha de emisi√≥n, calificaci√≥n obtenida y n√∫mero de firma electr√≥nica SAT.
                </p>
                <p>
                    <strong style="color: #1B2C27;">¬øTienes dudas?</strong><br>
                    Contacta con nosotros por WhatsApp: <a href="https://wa.me/529982570828" style="color: #1B2C27; font-weight: 600;">+52 998 257 0828</a>
                </p>
            </div>
        </div>
    </div>

    <!-- FOOTER -->
    <footer class="footer">
        <div class="footer-container">
            <div class="footer-section">
                <img src="https://i.postimg.cc/tCVcj2Sw/Captura-de-pantalla-2025-10-04-a-la-s-2-33-47-p-m.png" alt="Logo" style="height: 60px; margin-bottom: 20px;">
                <p>Formaci√≥n jur√≠dica accesible para todos.</p>
                <p style="margin-top: 15px; opacity: 0.8;">
                    ¬© 2025 Emp√≠rica Legal Lab<br>
                    Todos los derechos reservados
                </p>
            </div>
            
            <div class="footer-section">
                <h4>Verificaci√≥n</h4>
                <ul>
                    <li><a href="verificar.html">Verificar Diploma</a></li>
                    <li><a href="diplomas.html">Informaci√≥n de Diplomas</a></li>
                </ul>
            </div>
            
            <div class="footer-section">
                <h4>Emp√≠rica Legal Lab</h4>
                <ul>
                    <li><a href="index.html">Cat√°logo de Cursos</a></li>
                    <li><a href="contacto.html">Contacto</a></li>
                </ul>
            </div>
            
            <div class="footer-section">
                <h4>Contacto</h4>
                <p>üì± WhatsApp: +52 998 257 0828</p>
                <p>‚úâÔ∏è Email: jorge_clemente@empirica.mx</p>
            </div>
        </div>
        
        <div class="footer-bottom">
            <p>Desarrollado con ‚ù§Ô∏è para democratizar el conocimiento jur√≠dico</p>
        </div>
    </footer>

    <!-- BOT√ìN FLOTANTE WHATSAPP -->
    <a href="https://wa.me/529982570828?text=Hola,%20tengo%20una%20duda%20sobre%20verificaci√≥n%20de%20diplomas" class="whatsapp-float" target="_blank" title="Cont√°ctanos por WhatsApp">
        üì±
    </a>

    <script>
        // ============================================
        // SISTEMA DE VERIFICACI√ìN DE DIPLOMAS
        // ============================================

        // Obtener par√°metro de la URL (cuando escanean QR)
        function getURLParameter(name) {
            const urlParams = new URLSearchParams(window.location.search);
            return urlParams.get(name);
        }

        // Verificar autom√°ticamente si viene del QR
        window.addEventListener('load', function() {
            const diplomaId = getURLParameter('id');
            if (diplomaId) {
                document.getElementById('searchInput').value = diplomaId;
                verifyDiploma();
            }
        });

        // Funci√≥n principal de verificaci√≥n
        async function verifyDiploma() {
            const diplomaId = document.getElementById('searchInput').value.trim().toUpperCase();
            const resultDiv = document.getElementById('verificationResult');
            
            // Validar que se ingres√≥ un ID
            if (!diplomaId) {
                resultDiv.innerHTML = `
                    <div class="verify-status status-invalid">
                        ‚ùå Por favor ingresa un ID de diploma v√°lido
                    </div>
                `;
                return;
            }

            // Mostrar estado de carga
            resultDiv.innerHTML = `
                <div class="verify-status status-loading">
                    ‚è≥ Verificando diploma en nuestra base de datos...
                </div>
            `;

            try {
                // Cargar base de datos de diplomas desde GitHub
                const response = await fetch('data/diplomas.json');
                
                if (!response.ok) {
                    throw new Error('No se pudo cargar la base de datos');
                }
                
                const data = await response.json();
                
                // Buscar el diploma por ID
                const diploma = data.diplomas.find(d => d.id === diplomaId);
                
                if (diploma) {
                    // ‚úÖ DIPLOMA ENCONTRADO - V√ÅLIDO
                    resultDiv.innerHTML = `
                        <div class="verify-status status-valid">
                            ‚úÖ Diploma Verificado Exitosamente
                        </div>
                        
                        <div class="diploma-info">
                            <h3 style="color: #1B2C27; margin-bottom: 20px; text-align: center; font-size: 1.3rem;">
                                üìú Informaci√≥n del Diploma
                            </h3>
                            
                            <div class="info-row">
                                <span class="info-label">üÜî ID del Diploma:</span>
                                <span class="info-value">${diploma.id}</span>
                            </div>
                            
                            <div class="info-row">
                                <span class="info-label">üë§ Nombre Completo:</span>
                                <span class="info-value">${diploma.nombre_completo}</span>
                            </div>
                            
                            <div class="info-row">
                                <span class="info-label">üìö Curso:</span>
                                <span class="info-value">${diploma.curso}</span>
                            </div>
                            
                            <div class="info-row">
                                <span class="info-label">üìÖ Fecha de Emisi√≥n:</span>
                                <span class="info-value">${formatDate(diploma.fecha_emision)}</span>
                            </div>
                            
                            <div class="info-row">
                                <span class="info-label">üìä Calificaci√≥n:</span>
                                <span class="info-value">${diploma.calificacion}%</span>
                            </div>
                            
                            <div class="info-row">
                                <span class="info-label">üîê Firma Electr√≥nica SAT:</span>
                                <span class="info-value" style="font-family: monospace; font-size: 0.9rem;">${diploma.firma_sat}</span>
                            </div>
                        </div>
                        
                        <div style="background: #E8F3EA; padding: 20px; border-radius: 10px; margin-top: 20px; text-align: left;">
                            <h4 style="color: #155724; margin-bottom: 10px;">‚úì Certificaci√≥n V√°lida</h4>
                            <ul style="list-style: none; padding: 0; color: #155724; font-size: 0.95rem;">
                                <li style="margin-bottom: 8px;">‚úì Este diploma ha sido emitido oficialmente por Emp√≠rica Legal Lab</li>
                                <li style="margin-bottom: 8px;">‚úì Contiene firma electr√≥nica SAT con validez oficial</li>
                                <li style="margin-bottom: 8px;">‚úì Fecha de verificaci√≥n: ${new Date().toLocaleDateString('es-MX', {
                                    year: 'numeric',
                                    month: 'long',
                                    day: 'numeric'
                                })}</li>
                            </ul>
                        </div>
                    `;
                } else {
                    // ‚ùå DIPLOMA NO ENCONTRADO - INV√ÅLIDO
                    resultDiv.innerHTML = `
                        <div class="verify-status status-invalid">
                            ‚ùå Diploma No Encontrado
                        </div>
                        
                        <div style="background: #FFF3CD; padding: 20px; border-radius: 10px; margin-top: 20px; text-align: left;">
                            <p style="color: #856404; margin-bottom: 15px; font-size: 1.05rem;">
                                <strong>El ID "${diplomaId}" no corresponde a ning√∫n diploma emitido por Emp√≠rica Legal Lab.</strong>
                            </p>
                            <p style="color: #856404; font-size: 0.95rem; margin-bottom: 10px;">
                                Posibles causas:
                            </p>
                            <ul style="color: #856404; font-size: 0.95rem; margin-left: 20px;">
                                <li>El ID fue ingresado incorrectamente</li>
                                <li>El diploma es falso o no ha sido emitido por nosotros</li>
                                <li>El diploma est√° en proceso y a√∫n no ha sido registrado</li>
                            </ul>
                        </div>
                        
                        <div style="background: #F8D7DA; padding: 20px; border-radius: 10px; margin-top: 20px; border: 2px solid #DC3545;">
                            <h4 style="color: #721C24; margin-bottom: 15px;">‚ö†Ô∏è ¬øCrees que esto es un error?</h4>
                            <p style="color: #721C24; margin-bottom: 15px;">
                                Si compraste este diploma y crees que deber√≠a estar verificado, por favor cont√°ctanos inmediatamente:
                            </p>
                            <div style="color: #721C24;">
                                <p style="margin-bottom: 8px;"><strong>üì± WhatsApp:</strong> <a href="https://wa.me/529982570828?text=Hola,%20tengo%20un%20problema%20con%20la%20verificaci√≥n%20del%20diploma%20${diplomaId}" style="color: #721C24; text-decoration: underline;">+52 998 257 0828</a></p>
                                <p><strong>‚úâÔ∏è Email:</strong> jorge_clemente@empirica.mx</p>
                            </div>
                        </div>
                    `;
                }
            } catch (error) {
                // ‚ö†Ô∏è ERROR AL CARGAR LA BASE DE DATOS
                resultDiv.innerHTML = `
                    <div class="verify-status status-invalid">
                        ‚ùå Error de Conexi√≥n
                    </div>
                    <div style="background: #F8D7DA; padding: 20px; border-radius: 10px; margin-top: 20px;">
                        <p style="color: #721C24; margin-bottom: 15px;">
                            No se pudo conectar con la base de datos de diplomas. Por favor verifica:
                        </p>
                        <ul style="color: #721C24; margin-left: 20px; font-size: 0.95rem;">
                            <li>Que tengas conexi√≥n a internet</li>
                            <li>Que el sitio est√© funcionando correctamente</li>
                        </ul>
                        <p style="color: #721C24; margin-top: 15px;">
                            Si el problema persiste, contacta a soporte: <a href="https://wa.me/529982570828" style="color: #721C24; text-decoration: underline;">+52 998 257 0828</a>
                        </p>
                    </div>
                `;
                console.error('Error al verificar diploma:', error);
            }
        }

        // Formatear fechas en espa√±ol
        function formatDate(dateString) {
            const date = new Date(dateString + 'T00:00:00');
            return date.toLocaleDateString('es-MX', {
                year: 'numeric',
                month: 'long',
                day: 'numeric'
            });
        }

        // Men√∫ m√≥vil
        function toggleMenu() {
            document.getElementById('navMenu').classList.toggle('active');
        }

        // Cerrar men√∫ al hacer clic en un enlace
        document.querySelectorAll('.nav-menu a').forEach(link => {
            link.addEventListener('click', () => {
                const navMenu = document.getElementById('navMenu');
                if (navMenu.classList.contains('active')) {
                    navMenu.classList.remove('active');
                }
            });
        });
    </script>
</body>
</html>
